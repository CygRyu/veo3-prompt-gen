<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veo 3 Prompt Generator</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo%20no%20bg.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo%20no%20bg.png">
    <link rel="shortcut icon" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo%20no%20bg.png">
    
    <!-- Apple Touch Icon for iOS -->
    <link rel="apple-touch-icon" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo.png">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlZlbyAzIFByb21wdCBHZW5lcmF0b3IiLAogICJzaG9ydF9uYW1lIjogIlZlbyAzIEdlbiIsCiAgImRlc2NyaXB0aW9uIjogIlByb21wdCBlbmhhbmNlciBmb3IgVmVvIDMiLAogICJzdGFydF91cmwiOiAiLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgInRoZW1lX2NvbG9yIjogIiM2MzY2ZjEiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiMwZjEwMTkiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJodHRwczovL2dpdGh1Yi5jb20vQ3lnUnl1L3ZlbzMtcHJvbXB0LWdlbi9yYXcvbWFpbi9Mb2dvLnBuZyIsCiAgICAgICJzaXplcyI6ICIxOTJ4MTkyIiwKICAgICAgInR5cGUiOiAiaW1hZ2UvcG5nIgogICAgfSwKICAgIHsKICAgICAgInNyYyI6ICJodHRwczovL2dpdGh1Yi5jb20vQ3lnUnl1L3ZlbzMtcHJvbXB0LWdlbi9yYXcvbWFpbi9Mb2dvLnBuZyIsCiAgICAgICJzaXplcyI6ICI1MTJ4NTEyIiwKICAgICAgInR5cGUiOiAiaW1hZ2UvcG5nIgogICAgfQogIF0KfQ==">
    
    <!-- Meta Tags for Social Media Sharing -->
    <meta name="description" content="AI Studio for Veo 3 - Generate enhanced prompts for AI video creation with advanced customization options">
    <meta name="keywords" content="Veo 3, AI video, prompt generator, video generation, AI prompts">
    
    <!-- Open Graph Meta Tags (Facebook, LinkedIn, etc.) -->
    <meta property="og:title" content="Veo 3 Prompt Generator">
    <meta property="og:description" content="AI Studio for Veo 3">
    <meta property="og:image" content="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo.png">
    <meta property="og:url" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Veo 3 Prompt Generator">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Veo 3 Prompt Generator">
    <meta name="twitter:description" content="AI Studio for Veo 3">
    <meta name="twitter:image" content="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo.png">
    
    <!-- Apple Web App Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Veo 3 Gen">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            padding: 0;
            margin: 0;
            line-height: 1.5;
            background: linear-gradient(135deg, #0f1019 0%, #1a1b23 50%, #2d1b69 100%);
            color: #e2e8f0;
            min-height: 100vh;
        }

        /* Animated Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        /* Header Styles */
        .header {
            background: rgba(15, 16, 25, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
            padding: 16px 24px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #e2e8f0;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-tabs {
            display: flex;
            gap: 8px;
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
        }

        .guest-auth {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-dropdown {
            position: relative;
        }

        .user-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 8px;
            background: rgba(30, 32, 42, 0.8);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            color: #e2e8f0;
        }

        .user-button:hover {
            background: rgba(99, 102, 241, 0.1);
            border-color: #6366f1;
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.2);
        }

        .user-avatar {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }

        .dropdown-arrow {
            font-size: 12px;
            transition: transform 0.15s ease-in-out;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(30, 32, 42, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            min-width: 200px;
            z-index: 1000;
            display: none;
            margin-top: 4px;
        }

        .dropdown-menu.show {
            display: block;
        }

        .dropdown-header {
            padding: 12px 16px;
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
            font-size: 13px;
            color: #94a3b8;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            text-decoration: none;
            color: #e2e8f0;
            font-size: 14px;
            transition: background 0.3s ease;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
        }

        .dropdown-item:hover {
            background: rgba(99, 102, 241, 0.1);
        }

        .dropdown-divider {
            height: 1px;
            background: rgba(99, 102, 241, 0.2);
            margin: 4px 0;
        }

        /* Mobile Navigation */
        .mobile-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, rgba(15, 16, 25, 0.95) 0%, rgba(45, 27, 105, 0.95) 100%);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(99, 102, 241, 0.3);
            z-index: 100;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
        }

        .mobile-nav-tabs {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 8px 0;
        }

        .mobile-tab-button {
            background: none;
            border: none;
            color: #64748b;
            font-size: 24px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            min-width: 60px;
        }

        .mobile-tab-button.active {
            color: #6366f1;
            background: rgba(99, 102, 241, 0.1);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
        }

        .mobile-tab-button:hover {
            color: #6366f1;
            background: rgba(99, 102, 241, 0.05);
        }

        .mobile-tab-label {
            font-size: 10px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .mobile-menu-btn {
            display: none;
        }

        @media (max-width: 768px) {
            .header-content {
                padding: 0;
            }

            .nav-tabs {
                display: none !important;
            }

            .mobile-nav {
                display: block;
            }

            .logo {
                font-size: 20px;
            }

            .main-content {
                padding-bottom: 100px; /* Space for mobile nav */
            }
        }

        /* Main Content */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 16px 16px 100px 16px;
            }
        }
        
        h1 { 
            font-size: 32px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 32px;
            color: #e2e8f0;
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
            padding-bottom: 16px;
        }
        
        h2 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #e2e8f0;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
        }
        
        h3 {
            font-size: 16px;
            font-weight: 600;
            margin-top: 24px;
            margin-bottom: 12px;
            color: #94a3b8;
        }
        
        textarea, select, input[type="text"], input[type="range"], input[type="email"], input[type="search"], input[type="number"], input[type="tel"] { 
            width: 100%;
            padding: 12px 16px;
            margin: 8px 0 16px;
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            background: rgba(30, 32, 42, 0.8);
            color: #e2e8f0;
            transition: all 0.3s ease;
        }
        
        textarea:focus, select:focus, input[type="text"]:focus, input[type="email"]:focus, input[type="search"]:focus, input[type="number"]:focus, input[type="tel"]:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1), 0 0 20px rgba(99, 102, 241, 0.2);
            background: rgba(30, 32, 42, 0.95);
        }
        
        textarea {
            resize: vertical;
            min-height: 100px;
            font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, 'Liberation Mono', monospace;
        }
        
        label { 
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 6px;
            display: block;
            color: #e2e8f0;
        }
        
        button { 
            padding: 12px 20px;
            font-size: 14px;
            font-weight: 600;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        button:hover::before {
            left: 100%;
        }
        
        button:hover {
            background: linear-gradient(135deg, #059669, #047857);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
            transform: translateY(-2px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .generate-btn {
            display: block;
            margin: 32px auto;
            font-size: 16px;
            padding: 16px 32px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
        }

        .generate-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .generate-btn:hover::after {
            opacity: 1;
        }
        
        .generate-btn:hover {
            background: linear-gradient(135deg, #5b5ff5, #7c3aed);
            box-shadow: 0 12px 35px rgba(99, 102, 241, 0.4);
            transform: translateY(-3px);
        }
        
        .copy-btn {
            background: linear-gradient(135deg, #374151, #4b5563);
            font-size: 12px;
            padding: 8px 16px;
            margin-left: 12px;
            border-radius: 6px;
        }
        
        .copy-btn:hover {
            background: linear-gradient(135deg, #4b5563, #6b7280);
            box-shadow: 0 8px 25px rgba(75, 85, 99, 0.3);
        }
        
        .clear-btn {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            font-size: 14px;
            padding: 12px 24px;
            margin-right: 16px;
            border-radius: 8px;
        }
        
        .clear-btn:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.3);
        }
        
        .help-btn {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            font-size: 12px;
            padding: 8px 16px;
            margin-left: 8px;
            border-radius: 6px;
        }
        
        .help-btn:hover {
            background: linear-gradient(135deg, #7c3aed, #6d28d9);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
        }
        
        #output { 
            margin-top: 16px;
            background: rgba(30, 32, 42, 0.8);
            padding: 20px;
            border: 1px solid rgba(99, 102, 241, 0.3);
            white-space: pre-wrap;
            border-radius: 12px;
            font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, 'Liberation Mono', monospace;
            font-size: 13px;
            line-height: 1.45;
            color: #e2e8f0;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        @media (max-width: 480px) {
            .output-header {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }
            
            .copy-btn {
                margin-left: 0;
            }
        }
        
        .collapsible { 
            cursor: pointer;
            color: #6366f1;
            text-decoration: none;
            margin-bottom: 16px;
            padding: 16px 0;
            display: block;
            font-size: 16px;
            font-weight: 600;
            border: none;
            background: none;
            text-align: left;
            width: 100%;
            transition: all 0.3s ease;
            border-radius: 8px;
        }
        
        .collapsible:hover {
            background: rgba(99, 102, 241, 0.05);
            color: #8b5cf6;
            padding-left: 16px;
        }
        
        .advanced-section { 
            display: none;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
        }
        
        @media (min-width: 768px) {
            .form-grid-2 {
                grid-template-columns: 1fr 1fr;
            }
            
            .form-grid-3 {
                grid-template-columns: 1fr 1fr 1fr;
            }
        }
        
        .slider-container {
            margin-bottom: 20px;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .slider-value {
            font-weight: 500;
            color: #6366f1;
            font-size: 12px;
            background: rgba(99, 102, 241, 0.1);
            padding: 4px 8px;
            border-radius: 4px;
        }
        
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            border-radius: 3px;
            background: linear-gradient(90deg, rgba(99, 102, 241, 0.3), rgba(99, 102, 241, 0.1));
            outline: none;
            margin: 0;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            cursor: pointer;
            border: 2px solid rgba(15, 16, 25, 0.8);
            box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.3), 0 4px 12px rgba(99, 102, 241, 0.2);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            cursor: pointer;
            border: 2px solid rgba(15, 16, 25, 0.8);
            box-shadow: 0 0 0 1px rgba(99, 102, 241, 0.3), 0 4px 12px rgba(99, 102, 241, 0.2);
        }
        
        .section {
            background: rgba(30, 32, 42, 0.4);
            backdrop-filter: blur(10px);
            padding: 24px;
            margin: 24px 0;
            border-radius: 16px;
            border: 1px solid rgba(99, 102, 241, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.5), transparent);
        }
        
        .hidden {
            display: none;
        }
        
        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            padding: 12px 16px;
            margin: 16px 0;
            color: #fca5a5;
            font-size: 14px;
            backdrop-filter: blur(10px);
        }
        
        .popup-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            z-index: 1000;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.4s ease-in-out;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            min-width: 200px;
            backdrop-filter: blur(10px);
        }
        
        .popup-notification.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .popup-notification.success {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.9), rgba(5, 150, 105, 0.9));
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .popup-notification.error {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.9), rgba(220, 38, 38, 0.9));
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .popup-notification.warning {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.9), rgba(217, 119, 6, 0.9));
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .footer {
            text-align: center;
            margin-top: 48px;
            padding-top: 24px;
            border-top: 1px solid rgba(99, 102, 241, 0.2);
            color: #94a3b8;
            font-size: 14px;
        }
        
        .footer a {
            color: #6366f1;
            text-decoration: none;
            margin: 0 12px;
            transition: color 0.3s ease;
        }
        
        .footer a:hover {
            color: #8b5cf6;
            text-decoration: underline;
        }
        
        .gallery-placeholder {
            background: rgba(30, 32, 42, 0.6);
            padding: 48px 24px;
            text-align: center;
            color: #94a3b8;
            font-style: italic;
            border-radius: 12px;
            border: 1px solid rgba(99, 102, 241, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .video-gallery {
            display: none;
        }
        
        .video-container {
            position: relative;
            width: 100%;
            margin-bottom: 16px;
        }
        
        .video-frame {
            width: 100%;
            height: 315px;
            border: none;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        /* Enhanced 16:9 aspect ratio for video frames */
        @media (max-width: 560px) {
            .video-frame {
                height: calc(100vw * 9 / 16 - 32px); /* Responsive 16:9 ratio on mobile */
            }
        }
        
        .video-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 16px;
        }
        
        .video-nav-btn {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 18px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .video-nav-btn:hover {
            background: linear-gradient(135deg, #5b5ff5, #7c3aed);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }
        
        .video-nav-btn:disabled {
            background: linear-gradient(135deg, #374151, #4b5563);
            cursor: not-allowed;
            box-shadow: none;
        }
        
        .video-counter {
            font-size: 14px;
            color: #94a3b8;
            font-weight: 500;
        }
        
        .video-title {
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 600;
            color: #e2e8f0;
        }

        /* Tab Navigation */
        .tab-container {
            margin-bottom: 24px;
        }
        
        .tab-nav {
            display: flex;
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
            margin-bottom: 0;
            overflow-x: auto;
            background: rgba(30, 32, 42, 0.4);
            border-radius: 12px 12px 0 0;
            backdrop-filter: blur(10px);
        }
        
        .tab-button {
            background: none;
            border: none;
            padding: 16px 24px;
            font-size: 16px;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            position: relative;
            overflow: hidden;
        }

        .tab-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .tab-button:hover::before {
            opacity: 1;
        }
        
        .tab-button.active {
            color: #6366f1;
            border-bottom-color: #6366f1;
            background: rgba(99, 102, 241, 0.1);
        }
        
        .tab-button:hover {
            color: #6366f1;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .tab-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }
        
        .tab-title {
            font-size: 28px;
            font-weight: 700;
            color: #e2e8f0;
            margin: 0;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Toggle Switch */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 16px 0;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #374151, #4b5563);
            border-radius: 34px;
            transition: .4s;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            border-radius: 50%;
            transition: .4s;
        }
        
        input:checked + .toggle-slider {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        .toggle-labels {
            display: flex;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .toggle-label {
            padding: 6px 12px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .toggle-label.active {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
        }
        
        .toggle-label.inactive {
            color: #94a3b8;
        }
        
        /* Action Buttons Container */
        .action-buttons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
            margin: 32px 0;
        }
        
        @media (max-width: 480px) {
            .action-buttons {
                flex-direction: column;
                gap: 12px;
            }
            
            .clear-btn, .generate-btn {
                width: 100%;
                margin: 0;
            }
        }
        
        /* Help Modal */
        .help-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
        }
        
        .help-modal-content {
            background: rgba(30, 32, 42, 0.95);
            backdrop-filter: blur(10px);
            margin: 5% auto;
            padding: 24px;
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(99, 102, 241, 0.3);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        .help-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
        }
        
        .help-modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #e2e8f0;
            margin: 0;
        }
        
        .help-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #94a3b8;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .help-close:hover {
            color: #e2e8f0;
            background: rgba(99, 102, 241, 0.1);
        }
        
        .help-content {
            color: #e2e8f0;
            line-height: 1.6;
        }
        
        .help-content h4 {
            color: #6366f1;
            margin-top: 20px;
            margin-bottom: 8px;
            font-size: 16px;
            font-weight: 600;
        }
        
        .help-content ul {
            margin-left: 20px;
            margin-bottom: 16px;
        }
        
        .help-content li {
            margin-bottom: 6px;
        }
        
        .help-content .example {
            background: rgba(15, 16, 25, 0.6);
            padding: 16px;
            border-radius: 8px;
            border-left: 4px solid #6366f1;
            margin: 12px 0;
            font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, 'Liberation Mono', monospace;
            font-size: 13px;
        }

        /* Menu Tab Styles */
        .stats-card {
            background: rgba(30, 32, 42, 0.6);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .stats-card:hover {
            border-color: rgba(99, 102, 241, 0.4);
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 12px;
            color: #94a3b8;
            margin-top: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Admin Panel Styles */
        .admin-card {
            background: rgba(30, 32, 42, 0.6);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            backdrop-filter: blur(10px);
        }

        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
            border-radius: 8px;
            overflow: hidden;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
        }

        .data-table th {
            background: rgba(99, 102, 241, 0.1);
            font-weight: 600;
            font-size: 14px;
            color: #e2e8f0;
        }

        .data-table td {
            font-size: 13px;
            color: #e2e8f0;
        }

        .table-actions {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-bottom: 16px;
        }

        .search-input {
            max-width: 300px;
            margin: 0;
        }

        .filter-select {
            max-width: 200px;
            margin: 0;
        }

        .sign-in-prompt {
            text-align: center;
            padding: 48px 24px;
            background: rgba(30, 32, 42, 0.6);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            color: #94a3b8;
            backdrop-filter: blur(10px);
        }

        .sign-in-prompt h3 {
            color: #e2e8f0;
            margin-bottom: 16px;
        }

        /* Contact Form Styles */
        .contact-info {
            background: rgba(30, 32, 42, 0.6);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .contact-info h3 {
            color: #e2e8f0;
            margin-bottom: 12px;
        }

        .contact-info p {
            color: #94a3b8;
            margin-bottom: 16px;
        }

        .contact-email {
            color: #6366f1;
            font-weight: 600;
            font-size: 18px;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .contact-email:hover {
            color: #8b5cf6;
        }

        .required-field {
            color: #ef4444;
        }

        /* Light mode overrides (when user prefers light mode) */
        @media (prefers-color-scheme: light) {
            body {
                background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
                color: #1e293b;
            }

            body::before {
                background: 
                    radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.05) 0%, transparent 50%),
                    radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.05) 0%, transparent 50%),
                    radial-gradient(circle at 40% 80%, rgba(59, 130, 246, 0.05) 0%, transparent 50%);
            }

            .header {
                background: rgba(248, 250, 252, 0.95);
                border-bottom-color: rgba(99, 102, 241, 0.2);
            }

            .logo {
                color: #1e293b;
            }

            .user-button {
                background: rgba(255, 255, 255, 0.8);
                border-color: rgba(99, 102, 241, 0.3);
                color: #1e293b;
            }

            .user-button:hover {
                background: rgba(99, 102, 241, 0.1);
            }

            .dropdown-menu {
                background: rgba(255, 255, 255, 0.95);
                border-color: rgba(99, 102, 241, 0.3);
            }

            .dropdown-header {
                border-bottom-color: rgba(99, 102, 241, 0.2);
                color: #64748b;
            }

            .dropdown-item {
                color: #1e293b;
            }

            .dropdown-item:hover {
                background: rgba(99, 102, 241, 0.1);
            }

            .mobile-nav {
                background: linear-gradient(135deg, rgba(248, 250, 252, 0.95) 0%, rgba(226, 232, 240, 0.95) 100%);
                border-top-color: rgba(99, 102, 241, 0.3);
            }

            .mobile-tab-button {
                color: #64748b;
            }

            .mobile-tab-button.active {
                color: #6366f1;
            }

            h1, h2, .tab-title {
                color: #1e293b;
                border-bottom-color: rgba(99, 102, 241, 0.2);
            }

            h3, label {
                color: #475569;
            }

            textarea, select, input[type="text"], input[type="email"], input[type="search"], input[type="number"], input[type="tel"] {
                background: rgba(255, 255, 255, 0.8);
                border-color: rgba(99, 102, 241, 0.3);
                color: #1e293b;
            }

            textarea:focus, select:focus, input[type="text"]:focus, input[type="email"]:focus, input[type="search"]:focus, input[type="number"]:focus, input[type="tel"]:focus {
                background: rgba(255, 255, 255, 0.95);
            }

            #output {
                background: rgba(255, 255, 255, 0.8);
                border-color: rgba(99, 102, 241, 0.3);
                color: #1e293b;
            }

            .section, .admin-card, .stats-card, .contact-info {
                background: rgba(255, 255, 255, 0.4);
                border-color: rgba(99, 102, 241, 0.2);
            }

            .gallery-placeholder, .sign-in-prompt {
                background: rgba(255, 255, 255, 0.6);
                color: #64748b;
                border-color: rgba(99, 102, 241, 0.2);
            }

            .footer {
                border-top-color: rgba(99, 102, 241, 0.2);
                color: #64748b;
            }

            .collapsible {
                color: #6366f1;
            }

            .collapsible:hover {
                background: rgba(99, 102, 241, 0.05);
            }

            .slider-value {
                color: #6366f1;
                background: rgba(99, 102, 241, 0.1);
            }

            .error-message {
                background: rgba(239, 68, 68, 0.1);
                border-color: rgba(239, 68, 68, 0.3);
                color: #dc2626;
            }

            .video-title {
                color: #1e293b;
            }

            .video-counter {
                color: #64748b;
            }

            .tab-nav {
                border-bottom-color: rgba(99, 102, 241, 0.2);
                background: rgba(255, 255, 255, 0.4);
            }

            .tab-button {
                color: #64748b;
            }

            .tab-button.active {
                color: #6366f1;
                background: rgba(99, 102, 241, 0.1);
            }

            .help-modal-content {
                background: rgba(255, 255, 255, 0.95);
                border-color: rgba(99, 102, 241, 0.3);
            }

            .help-modal-header {
                border-bottom-color: rgba(99, 102, 241, 0.2);
            }

            .help-modal-title {
                color: #1e293b;
            }

            .help-close {
                color: #64748b;
            }

            .help-close:hover {
                color: #1e293b;
                background: rgba(99, 102, 241, 0.1);
            }

            .help-content {
                color: #1e293b;
            }

            .help-content h4 {
                color: #6366f1;
            }

            .help-content .example {
                background: rgba(248, 250, 252, 0.6);
                border-left-color: #6366f1;
            }

            .data-table th {
                background: rgba(99, 102, 241, 0.1);
                color: #1e293b;
            }

            .data-table td {
                color: #1e293b;
            }

            .data-table th,
            .data-table td {
                border-bottom-color: rgba(99, 102, 241, 0.2);
            }

            .sign-in-prompt h3, .contact-info h3 {
                color: #1e293b;
            }

            .contact-info p {
                color: #64748b;
            }

            .contact-email {
                color: #6366f1;
            }

            .contact-email:hover {
                color: #8b5cf6;
            }
        }
    </style>
<script type="text/javascript" src="https://app.sandbox.midtrans.com/snap/snap.js" data-client-key="Mid-client-2M6WJwQ0MmVfRkY5"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">
                🎬 Veo 3 Prompt Gen
            </a>
            
            <nav class="nav-tabs" id="navTabs">
                <button class="tab-button active" onclick="switchTab('enhance')">✨ Enhance</button>
                <button class="tab-button" onclick="switchTab('remix')">🎛️ Remix</button>
                <button class="tab-button" onclick="switchTab('menu')" id="menuTabBtn">📋 Menu</button>
                <button class="tab-button hidden" onclick="switchTab('admin')" id="adminTabBtn">⚙️ Admin</button>
                <button class="tab-button" onclick="switchTab('contact')">📞 Contact</button>
            </nav>

            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">☰</button>
            
            <div class="user-section">
                <!-- Guest State -->
                <div class="guest-auth" id="guestAuth">
                    <button class="copy-btn" id="signInBtn">🔐 Sign in with Google</button>
                </div>

                <!-- User State -->
                <div class="user-dropdown hidden" id="userDropdown">
                    <button class="user-button" onclick="toggleUserDropdown()">
                        <div class="user-avatar" id="userAvatar">U</div>
                        <span id="userName">User</span>
                        <span class="dropdown-arrow">▼</span>
                    </button>
                    <div class="dropdown-menu" id="dropdownMenu">
                        <div class="dropdown-header">
                            <div id="userEmail">user@example.com</div>
                            <div id="quotaDisplay">🎟️ 0 prompts left</div>
                        </div>
                        <button class="dropdown-item" onclick="switchTab('menu')">
                            📋 Menu & Redeem
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="signOutBtn">
                            🚪 Sign Out
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Navigation -->
    <nav class="mobile-nav" id="mobileNav">
        <div class="mobile-nav-tabs">
            <button class="mobile-tab-button active" onclick="switchTab('enhance')" id="mobileEnhanceBtn">
                <div>✨</div>
                <div class="mobile-tab-label">Enhance</div>
            </button>
            <button class="mobile-tab-button" onclick="switchTab('remix')" id="mobileRemixBtn">
                <div>🎛️</div>
                <div class="mobile-tab-label">Remix</div>
            </button>
            <button class="mobile-tab-button" onclick="switchTab('menu')" id="mobileMenuBtn">
                <div>📋</div>
                <div class="mobile-tab-label">Menu</div>
            </button>
            <button class="mobile-tab-button hidden" onclick="switchTab('admin')" id="mobileAdminBtn">
                <div>⚙️</div>
                <div class="mobile-tab-label">Admin</div>
            </button>
            <button class="mobile-tab-button" onclick="switchTab('contact')" id="mobileContactBtn">
                <div>📞</div>
                <div class="mobile-tab-label">Contact</div>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Enhance Tab Content -->
        <div id="enhanceTab" class="tab-content active">
            <div class="tab-header">
                <h2 class="tab-title">Enhance Your Prompt</h2>
                <button class="help-btn" onclick="showHelp('enhance')">❓ Help</button>
            </div>

            <!-- Basic Settings -->
            <div class="section">
                <h2>Basic Settings</h2>
                
                <label for="description">Your Prompt *</label>
                <textarea id="description" rows="4" placeholder="e.g. A cat flying through a futuristic city during a thunderstorm..."></textarea>

                <div class="form-grid form-grid-2">
                    <div>
                        <label for="subject">Subject / Character Focus</label>
                        <input id="subject" type="text" placeholder="e.g. Cat, Robot, Samurai, Cloud, etc."/>
                    </div>
                    
                    <div>
                        <label for="action">Action / Movement Type</label>
                        <select id="action">
                            <option value="">Auto Detect</option>
                            <option>Walking</option>
                            <option>Dancing</option>
                            <option>Flying</option>
                            <option>Transformation</option>
                            <option>Interaction</option>
                            <option>Running</option>
                            <option>Jumping</option>
                            <option>Swimming</option>
                            <option>Climbing</option>
                        </select>
                    </div>
                </div>

                <label for="style">Video Style</label>
                <select id="style">
                    <option>Auto Detect (AI chooses best style)</option>
                    <option>Cinematic / Hollywood Film</option>
                    <option>Realistic Live Action</option>
                    <option>Aerial Cinematic Drone Shot</option>
                    <option>Time-lapse / Slow Motion</option>
                    <option>Film Noir / Black-and-White</option>
                    <option>Analog / Film Grain</option>
                    <option>IMAX Look</option>
                    <option>Documentary Style</option>
                    <option>Natural History / Wildlife</option>
                    <option>Found Footage / Handheld Cam</option>
                    <option>News Report Style</option>
                    <option>Surveillance Footage Look</option>
                    <option>Dreamscape / Surreal</option>
                    <option>Fantasy / Magic Realism</option>
                    <option>Oil Painting / Watercolor</option>
                    <option>Sketch / Ink Drawing</option>
                    <option>Abstract / Experimental</option>
                    <option>Double Exposure / Visual Metaphor</option>
                    <option>Stylized 2D Animation / Anime-like</option>
                    <option>Cartoon 2D</option>
                    <option>Cute Cartoon / Kawaii Style</option>
                    <option>Cartoon 3D / Pixar-like</option>
                    <option>Stop Motion Look</option>
                    <option>Claymation Style</option>
                    <option>Motion Graphic / Minimal Vector</option>
                    <option>Retro 80s / VHS Look</option>
                    <option>Cyberpunk / Futuristic</option>
                    <option>Noir Detective Style</option>
                    <option>Western / Cowboy Film</option>
                    <option>Horror (grainy, eerie lighting)</option>
                    <option>Tiny World / Tilt Shift</option>
                    <option>Microscopic View / Science-Lab Look</option>
                    <option>Macro Lens Simulation</option>
                    <option>Cinematic Portrait Mode</option>
                    <option>Bokeh-Focused Depth-of-Field</option>
                    <option>Overexposed / Underexposed Look</option>
                    <option>Infrared or Thermal Cam Simulation</option>
                    <option>Isometric / Diorama</option>
                    <option>Fantasy Landscapes</option>
                    <option>Post-Apocalyptic World</option>
                    <option>Urban Street Aesthetic</option>
                    <option>Studio Look (ASMR/Product Videos)</option>
                    <option>Video Game Gameplay</option>
                </select>
            </div>

            <!-- Video Tone/Genre -->
            <div class="section">
                <h2>Video Tone/Genre</h2>
                
                <div class="form-grid form-grid-2">
                    <div>
                        <label for="generalTone">General Tone</label>
                        <select id="generalTone" onchange="updateSubTones('enhance')">
                            <option value="">Auto Detect</option>
                            <option value="emotional">Emotional Tones</option>
                            <option value="suspense">Suspense & Thriller Tones</option>
                            <option value="action">Action & Adventure Tones</option>
                            <option value="artistic">Artistic & Creative Tones</option>
                            <option value="documentary">Documentary & Realistic Tones</option>
                            <option value="fantasy">Fantasy & Sci-Fi Tones</option>
                            <option value="social">Social & Cultural Tones</option>
                            <option value="unique">Unique/Niche Tones</option>
                        </select>
                    </div>

                    <div>
                        <label for="subTone">Specific Tone</label>
                        <select id="subTone">
                            <option value="">Auto Detect</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Technical Settings -->
            <div class="section">
                <h2>Technical Settings</h2>
                
                <div class="form-grid form-grid-2">
                    <div>
                        <label for="aspectRatio">Aspect Ratio</label>
                        <select id="aspectRatio">
                            <option value="16:9">16:9 (Widescreen)</option>
                            <option value="9:16">9:16 (Vertical)</option>
                            <option value="1:1">1:1 (Square)</option>
                            <option value="4:3">4:3 (Standard)</option>
                            <option value="21:9">21:9 (Ultra-wide)</option>
                        </select>
                    </div>

                    <div>
                        <label for="duration">Duration</label>
                        <input id="duration" type="text" value="8 seconds" readonly style="background-color: rgba(64, 64, 64, 0.5); color: #94a3b8;"/>
                    </div>
                </div>
            </div>

            <!-- Advanced Parameters -->
            <button class="collapsible" onclick="toggleAdvanced('enhance')">+ Advanced Parameters (Optional)</button>
            <div id="enhanceAdvanced" class="advanced-section">
                <div class="section">
                    <!-- Camera Settings -->
                    <h3>Camera Settings</h3>
                    <div class="form-grid form-grid-3">
                        <div>
                            <label for="cameraMovement">Camera Movement</label>
                            <select id="cameraMovement">
                                <option>Auto Detect</option>
                                <option>Static</option>
                                <option>Pan Left/Right</option>
                                <option>Zoom In/Out</option>
                                <option>Dolly Forward/Back</option>
                                <option>Steadycam</option>
                                <option>Handheld</option>
                                <option>Orbital</option>
                                <option>Tracking Shot</option>
                                <option>Crane</option>
                                <option>Drone</option>
                            </select>
                        </div>

                        <div>
                            <label for="cameraLevel">Camera Level</label>
                            <select id="cameraLevel">
                                <option>Auto Detect</option>
                                <option>Eye Level</option>
                                <option>Low Angle</option>
                                <option>High Angle</option>
                                <option>Dutch Angle</option>
                                <option>Overhead</option>
                                <option>Point of View</option>
                            </select>
                        </div>

                        <div>
                            <label for="lensType">Lens Type</label>
                            <select id="lensType">
                                <option>Auto Detect</option>
                                <option>Standard (50mm)</option>
                                <option>Wide Angle (24mm)</option>
                                <option>Telephoto (85mm+)</option>
                                <option>Fisheye</option>
                                <option>Anamorphic</option>
                                <option>Macro</option>
                            </select>
                        </div>
                    </div>

                    <!-- Visual Settings -->
                    <h3>Visual Settings</h3>
                    <div class="form-grid form-grid-2">
                        <div>
                            <label for="depthOfField">Depth of Field</label>
                            <select id="depthOfField">
                                <option>Auto Detect</option>
                                <option>Shallow</option>
                                <option>Medium</option>
                                <option>Deep</option>
                            </select>
                        </div>

                        <div>
                            <label for="lighting">Lighting Preference</label>
                            <select id="lighting">
                                <option>Auto Detect</option>
                                <option>Natural</option>
                                <option>Dramatic</option>
                                <option>Soft</option>
                                <option>Harsh</option>
                                <option>Golden Hour</option>
                                <option>Blue Hour</option>
                                <option>Neon</option>
                                <option>Candlelit</option>
                                <option>Studio Lighting</option>
                            </select>
                        </div>
                    </div>

                    <!-- Visual Effects Sliders -->
                    <h3>Visual Effects</h3>
                    <div class="slider-container">
                        <div class="slider-label">
                            <label for="filmGrain">Film Grain</label>
                            <span class="slider-value" id="filmGrainValue">0%</span>
                        </div>
                        <input type="range" id="filmGrain" min="0" max="100" value="0" oninput="updateSliderValue('filmGrain')">
                    </div>

                    <div class="slider-container">
                        <div class="slider-label">
                            <label for="chromaticAberration">Chromatic Aberration</label>
                            <span class="slider-value" id="chromaticAberrationValue">0%</span>
                        </div>
                        <input type="range" id="chromaticAberration" min="0" max="100" value="0" oninput="updateSliderValue('chromaticAberration')">
                    </div>

                    <!-- Environment & Atmosphere -->
                    <h3>Environment & Atmosphere</h3>
                    <div class="form-grid form-grid-3">
                        <div>
                            <label for="environment">Environment/Setting</label>
                            <select id="environment">
                                <option>Auto Detect</option>
                                <option>Indoor</option>
                                <option>Outdoor</option>
                                <option>Urban</option>
                                <option>Rural</option>
                                <option>Fantasy World</option>
                                <option>Space</option>
                                <option>Underwater</option>
                                <option>Desert</option>
                                <option>Forest</option>
                                <option>City</option>
                            </select>
                        </div>

                        <div>
                            <label for="colorPalette">Color Palette</label>
                            <select id="colorPalette">
                                <option>Auto Detect</option>
                                <option>Warm Tones</option>
                                <option>Cool Tones</option>
                                <option>Monochrome</option>
                                <option>Vibrant</option>
                                <option>Muted</option>
                                <option>Neon</option>
                                <option>Pastel</option>
                                <option>High Contrast</option>
                            </select>
                        </div>

                        <div>
                            <label for="weather">Weather/Atmosphere</label>
                            <select id="weather">
                                <option>Auto Detect</option>
                                <option>Sunny</option>
                                <option>Cloudy</option>
                                <option>Rainy</option>
                                <option>Foggy</option>
                                <option>Stormy</option>
                                <option>Snowy</option>
                                <option>Windy</option>
                                <option>Misty</option>
                                <option>Clear</option>
                            </select>
                        </div>

                        <div>
                            <label for="timeOfDay">Time of Day</label>
                            <select id="timeOfDay">
                                <option>Auto Detect</option>
                                <option>Dawn</option>
                                <option>Morning</option>
                                <option>Midday</option>
                                <option>Afternoon</option>
                                <option>Dusk</option>
                                <option>Night</option>
                                <option>Midnight</option>
                            </select>
                        </div>

                        <div>
                            <label for="motionIntensity">Motion Intensity</label>
                            <select id="motionIntensity">
                                <option>Auto Detect</option>
                                <option>Subtle</option>
                                <option>Moderate</option>
                                <option>Dynamic</option>
                                <option>Explosive</option>
                                <option>Graceful</option>
                            </select>
                        </div>

                        <div>
                            <label for="moodEmotion">Mood/Emotion</label>
                            <select id="moodEmotion">
                                <option>Auto Detect</option>
                                <option>Happy</option>
                                <option>Mysterious</option>
                                <option>Tense</option>
                                <option>Peaceful</option>
                                <option>Energetic</option>
                                <option>Melancholic</option>
                                <option>Triumphant</option>
                                <option>Romantic</option>
                            </select>
                        </div>
                    </div>

                    <!-- Dialogue/Text Overlay -->
                    <label for="dialogue">Dialogue/Text Overlay (Optional)</label>
                    <textarea id="dialogue" rows="2" placeholder="Enter any dialogue or text elements to include..."></textarea>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="clear-btn" onclick="clearForm('enhance')">🗑️ Clear All</button>
                <button class="generate-btn" onclick="generatePrompt()">✨ Enhance Prompt</button>
            </div>

            <!-- Output Section -->
            <div id="enhanceOutputSection" class="hidden">
                <div class="output-header">
                    <h2>Enhanced Prompt</h2>
                    <button class="copy-btn" onclick="copyPrompt('enhanceOutput')">📋 Copy Prompt</button>
                </div>
                <div id="enhanceOutput"></div>
            </div>

            <!-- Sample Gallery -->
            <div class="section">
                <button class="collapsible" onclick="toggleGallery('enhance')">+ Sample Gallery</button>
                <div id="enhanceVideoGallery" class="video-gallery">
                    <div class="video-container">
                        <div class="video-title" id="enhanceVideoTitle">Sample Video 1</div>
                        <iframe id="enhanceVideoFrame" class="video-frame" src="about:blank" allowfullscreen></iframe>
                    </div>
                    <div class="video-navigation">
                        <button class="video-nav-btn" id="enhancePrevBtn" onclick="previousVideo('enhance')">← Previous</button>
                        <span class="video-counter" id="enhanceVideoCounter">1 / 3</span>
                        <button class="video-nav-btn" id="enhanceNextBtn" onclick="nextVideo('enhance')">Next →</button>
                    </div>
                </div>
                <div id="enhanceGalleryPlaceholder" class="gallery-placeholder">
                    Click on expand button above to view sample videos
                </div>
            </div>
        </div>

        <!-- Remix Tab Content -->
        <div id="remixTab" class="tab-content">
            <div class="tab-header">
                <h2 class="tab-title">Remix Existing Prompt</h2>
                <button class="help-btn" onclick="showHelp('remix')">❓ Help</button>
            </div>

            <!-- Remix Input Section -->
            <div class="section">
                <h2>Original Prompt & Variations</h2>
                
                <label for="originalPrompt">Original Prompt *</label>
                <textarea id="originalPrompt" rows="6" placeholder="Paste your existing prompt here... (can be any length from simple to detailed)"></textarea>

                <label for="variationInstructions">How to Vary This Prompt *</label>
                <textarea id="variationInstructions" rows="4" placeholder="e.g. Make the creature a giant lobster instead, and the view is from a drone, the time of day is dusk, the tone is chilling and gritty. And there is a deep old man voice narrating that says 'Earth is facing her end of time..'"></textarea>

                <!-- Simple/Advanced Toggle -->
                <div class="toggle-container">
                    <span class="toggle-labels">
                        <span class="toggle-label active" id="simpleLabel">Simple</span>
                        <span class="toggle-label inactive" id="advancedLabel">Advanced</span>
                    </span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="remixModeToggle" onchange="toggleRemixMode()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <!-- Advanced Remix Parameters (Hidden by default) -->
            <div id="remixAdvancedSection" class="hidden">
                <!-- Basic Settings -->
                <div class="section">
                    <h2>Basic Settings</h2>
                    
                    <div class="form-grid form-grid-2">
                        <div>
                            <label for="remixSubject">Subject / Character Focus</label>
                            <input id="remixSubject" type="text" placeholder="e.g. Cat, Robot, Samurai, Cloud, etc."/>
                        </div>
                        
                        <div>
                            <label for="remixAction">Action / Movement Type</label>
                            <select id="remixAction">
                                <option value="">Auto Detect</option>
                                <option>Walking</option>
                                <option>Dancing</option>
                                <option>Flying</option>
                                <option>Transformation</option>
                                <option>Interaction</option>
                                <option>Running</option>
                                <option>Jumping</option>
                                <option>Swimming</option>
                                <option>Climbing</option>
                            </select>
                        </div>
                    </div>

                    <label for="remixStyle">Video Style</label>
                    <select id="remixStyle">
                        <option>Auto Detect (AI chooses best style)</option>
                        <option>Cinematic / Hollywood Film</option>
                        <option>Realistic Live Action</option>
                        <option>Aerial Cinematic Drone Shot</option>
                        <option>Time-lapse / Slow Motion</option>
                        <option>Film Noir / Black-and-White</option>
                        <option>Analog / Film Grain</option>
                        <option>IMAX Look</option>
                        <option>Documentary Style</option>
                        <option>Natural History / Wildlife</option>
                        <option>Found Footage / Handheld Cam</option>
                        <option>News Report Style</option>
                        <option>Surveillance Footage Look</option>
                        <option>Dreamscape / Surreal</option>
                        <option>Fantasy / Magic Realism</option>
                        <option>Oil Painting / Watercolor</option>
                        <option>Sketch / Ink Drawing</option>
                        <option>Abstract / Experimental</option>
                        <option>Double Exposure / Visual Metaphor</option>
                        <option>Stylized 2D Animation / Anime-like</option>
                        <option>Cartoon 2D</option>
                        <option>Cute Cartoon / Kawaii Style</option>
                        <option>Cartoon 3D / Pixar-like</option>
                        <option>Stop Motion Look</option>
                        <option>Claymation Style</option>
                        <option>Motion Graphic / Minimal Vector</option>
                        <option>Retro 80s / VHS Look</option>
                        <option>Cyberpunk / Futuristic</option>
                        <option>Noir Detective Style</option>
                        <option>Western / Cowboy Film</option>
                        <option>Horror (grainy, eerie lighting)</option>
                        <option>Tiny World / Tilt Shift</option>
                        <option>Microscopic View / Science-Lab Look</option>
                        <option>Macro Lens Simulation</option>
                        <option>Cinematic Portrait Mode</option>
                        <option>Bokeh-Focused Depth-of-Field</option>
                        <option>Overexposed / Underexposed Look</option>
                        <option>Infrared or Thermal Cam Simulation</option>
                        <option>Isometric / Diorama</option>
                        <option>Fantasy Landscapes</option>
                        <option>Post-Apocalyptic World</option>
                        <option>Urban Street Aesthetic</option>
                        <option>Studio Look (ASMR/Product Videos)</option>
                        <option>Video Game Gameplay</option>
                    </select>
                </div>

                <!-- Video Tone/Genre -->
                <div class="section">
                    <h2>Video Tone/Genre</h2>
                    
                    <div class="form-grid form-grid-2">
                        <div>
                            <label for="remixGeneralTone">General Tone</label>
                            <select id="remixGeneralTone" onchange="updateSubTones('remix')">
                                <option value="">Auto Detect</option>
                                <option value="emotional">Emotional Tones</option>
                                <option value="suspense">Suspense & Thriller Tones</option>
                                <option value="action">Action & Adventure Tones</option>
                                <option value="artistic">Artistic & Creative Tones</option>
                                <option value="documentary">Documentary & Realistic Tones</option>
                                <option value="fantasy">Fantasy & Sci-Fi Tones</option>
                                <option value="social">Social & Cultural Tones</option>
                                <option value="unique">Unique/Niche Tones</option>
                            </select>
                        </div>

                        <div>
                            <label for="remixSubTone">Specific Tone</label>
                            <select id="remixSubTone">
                                <option value="">Auto Detect</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Technical Settings -->
                <div class="section">
                    <h2>Technical Settings</h2>
                    
                    <div class="form-grid form-grid-2">
                        <div>
                            <label for="remixAspectRatio">Aspect Ratio</label>
                            <select id="remixAspectRatio">
                                <option value="16:9">16:9 (Widescreen)</option>
                                <option value="9:16">9:16 (Vertical)</option>
                                <option value="1:1">1:1 (Square)</option>
                                <option value="4:3">4:3 (Standard)</option>
                                <option value="21:9">21:9 (Ultra-wide)</option>
                            </select>
                        </div>

                        <div>
                            <label for="remixDuration">Duration</label>
                            <input id="remixDuration" type="text" value="8 seconds" readonly style="background-color: rgba(64, 64, 64, 0.5); color: #94a3b8;"/>
                        </div>
                    </div>
                </div>

                <!-- Advanced Parameters -->
                <button class="collapsible" onclick="toggleAdvanced('remix')">+ Advanced Parameters (Optional)</button>
                <div id="remixAdvanced" class="advanced-section">
                    <div class="section">
                        <!-- Camera Settings -->
                        <h3>Camera Settings</h3>
                        <div class="form-grid form-grid-3">
                            <div>
                                <label for="remixCameraMovement">Camera Movement</label>
                                <select id="remixCameraMovement">
                                    <option>Auto Detect</option>
                                    <option>Static</option>
                                    <option>Pan Left/Right</option>
                                    <option>Zoom In/Out</option>
                                    <option>Dolly Forward/Back</option>
                                    <option>Steadycam</option>
                                    <option>Handheld</option>
                                    <option>Orbital</option>
                                    <option>Tracking Shot</option>
                                    <option>Crane</option>
                                    <option>Drone</option>
                                </select>
                            </div>

                            <div>
                                <label for="remixCameraLevel">Camera Level</label>
                                <select id="remixCameraLevel">
                                    <option>Auto Detect</option>
                                    <option>Eye Level</option>
                                    <option>Low Angle</option>
                                    <option>High Angle</option>
                                    <option>Dutch Angle</option>
                                    <option>Overhead</option>
                                    <option>Point of View</option>
                                </select>
                            </div>

                            <div>
                                <label for="remixLensType">Lens Type</label>
                                <select id="remixLensType">
                                    <option>Auto Detect</option>
                                    <option>Standard (50mm)</option>
                                    <option>Wide Angle (24mm)</option>
                                    <option>Telephoto (85mm+)</option>
                                    <option>Fisheye</option>
                                    <option>Anamorphic</option>
                                    <option>Macro</option>
                                </select>
                            </div>
                        </div>

                        <!-- Visual Settings -->
                        <h3>Visual Settings</h3>
                        <div class="form-grid form-grid-2">
                            <div>
                                <label for="remixDepthOfField">Depth of Field</label>
                                <select id="remixDepthOfField">
                                    <option>Auto Detect</option>
                                    <option>Shallow</option>
                                    <option>Medium</option>
                                    <option>Deep</option>
                                </select>
                            </div>

                            <div>
                                <label for="remixLighting">Lighting Preference</label>
                                <select id="remixLighting">
                                    <option>Auto Detect</option>
                                    <option>Natural</option>
                                    <option>Dramatic</option>
                                    <option>Soft</option>
                                    <option>Harsh</option>
                                    <option>Golden Hour</option>
                                    <option>Blue Hour</option>
                                    <option>Neon</option>
                                    <option>Candlelit</option>
                                    <option>Studio Lighting</option>
                                </select>
                            </div>
                        </div>

                        <!-- Visual Effects Sliders -->
                        <h3>Visual Effects</h3>
                        <div class="slider-container">
                            <div class="slider-label">
                                <label for="remixFilmGrain">Film Grain</label>
                                <span class="slider-value" id="remixFilmGrainValue">0%</span>
                            </div>
                            <input type="range" id="remixFilmGrain" min="0" max="100" value="0" oninput="updateSliderValue('remixFilmGrain')">
                        </div>

                        <div class="slider-container">
                            <div class="slider-label">
                                <label for="remixChromaticAberration">Chromatic Aberration</label>
                                <span class="slider-value" id="remixChromaticAberrationValue">0%</span>
                            </div>
                            <input type="range" id="remixChromaticAberration" min="0" max="100" value="0" oninput="updateSliderValue('remixChromaticAberration')">
                        </div>

                        <!-- Environment & Atmosphere -->
                        <h3>Environment & Atmosphere</h3>
                        <div class="form-grid form-grid-3">
                            <div>
                                <label for="remixEnvironment">Environment/Setting</label>
                                <select id="remixEnvironment">
                                    <option>Auto Detect</option>
                                    <option>Indoor</option>
                                    <option>Outdoor</option>
                                    <option>Urban</option>
                                    <option>Rural</option>
                                    <option>Fantasy World</option>
                                    <option>Space</option>
                                    <option>Underwater</option>
                                    <option>Desert</option>
                                    <option>Forest</option>
                                    <option>City</option>
                                </select>
                            </div>

                            <div>
                                <label for="remixColorPalette">Color Palette</label>
                                <select id="remixColorPalette">
                                    <option>Auto Detect</option>
                                    <option>Warm Tones</option>
                                    <option>Cool Tones</option>
                                    <option>Monochrome</option>
                                    <option>Vibrant</option>
                                    <option>Muted</option>
                                    <option>Neon</option>
                                    <option>Pastel</option>
                                    <option>High Contrast</option>
                                </select>
                            </div>

                            <div>
                                <label for="remixWeather">Weather/Atmosphere</label>
                                <select id="remixWeather">
                                    <option>Auto Detect</option>
                                    <option>Sunny</option>
                                    <option>Cloudy</option>
                                    <option>Rainy</option>
                                    <option>Foggy</option>
                                    <option>Stormy</option>
                                    <option>Snowy</option>
                                    <option>Windy</option>
                                    <option>Misty</option>
                                    <option>Clear</option>
                                </select>
                            </div>

                            <div>
                                <label for="remixTimeOfDay">Time of Day</label>
                                <select id="remixTimeOfDay">
                                    <option>Auto Detect</option>
                                    <option>Dawn</option>
                                    <option>Morning</option>
                                    <option>Midday</option>
                                    <option>Afternoon</option>
                                    <option>Dusk</option>
                                    <option>Night</option>
                                    <option>Midnight</option>
                                </select>
                            </div>

                            <div>
                                <label for="remixMotionIntensity">Motion Intensity</label>
                                <select id="remixMotionIntensity">
                                    <option>Auto Detect</option>
                                    <option>Subtle</option>
                                    <option>Moderate</option>
                                    <option>Dynamic</option>
                                    <option>Explosive</option>
                                    <option>Graceful</option>
                                </select>
                            </div>

                            <div>
                                <label for="remixMoodEmotion">Mood/Emotion</label>
                                <select id="remixMoodEmotion">
                                    <option>Auto Detect</option>
                                    <option>Happy</option>
                                    <option>Mysterious</option>
                                    <option>Tense</option>
                                    <option>Peaceful</option>
                                    <option>Energetic</option>
                                    <option>Melancholic</option>
                                    <option>Triumphant</option>
                                    <option>Romantic</option>
                                </select>
                            </div>
                        </div>

                        <!-- Dialogue/Text Overlay -->
                        <label for="remixDialogue">Dialogue/Text Overlay (Optional)</label>
                        <textarea id="remixDialogue" rows="2" placeholder="Enter any dialogue or text elements to include..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="clear-btn" onclick="clearForm('remix')">🗑️ Clear All</button>
                <button class="generate-btn" onclick="remixPrompt()">🎛️ Remix Prompt</button>
            </div>

            <!-- Output Section -->
            <div id="remixOutputSection" class="hidden">
                <div class="output-header">
                    <h2>Remixed Prompt</h2>
                    <button class="copy-btn" onclick="copyPrompt('remixOutput')">📋 Copy Prompt</button>
                </div>
                <div id="remixOutput"></div>
            </div>

            <!-- Sample Gallery -->
            <div class="section">
                <button class="collapsible" onclick="toggleGallery('remix')">+ Sample Gallery</button>
                <div id="remixVideoGallery" class="video-gallery">
                    <div class="video-container">
                        <div class="video-title" id="remixVideoTitle">Sample Video 1</div>
                        <iframe id="remixVideoFrame" class="video-frame" src="about:blank" allowfullscreen></iframe>
                    </div>
                    <div class="video-navigation">
                        <button class="video-nav-btn" id="remixPrevBtn" onclick="previousVideo('remix')">← Previous</button>
                        <span class="video-counter" id="remixVideoCounter">1 / 3</span>
                        <button class="video-nav-btn" id="remixNextBtn" onclick="nextVideo('remix')">Next →</button>
                    </div>
                </div>
                <div id="remixGalleryPlaceholder" class="gallery-placeholder">
                    Click on expand button above to view sample videos
                </div>
            </div>
        </div>

        <!-- Menu Tab Content -->
        <div id="menuTab" class="tab-content">
            <div class="tab-header">
                <h2 class="tab-title">Menu & Account</h2>
            </div>

            <!-- Sign In Prompt (for guests) -->
            <div id="menuSignInPrompt" class="sign-in-prompt">
                <h3>Sign In Required</h3>
                <p>Please sign in to access your account menu, redeem codes, and view your usage statistics.</p>
                <button class="generate-btn" onclick="signIn()" style="margin-top: 16px;">🔐 Sign in with Google</button>
            </div>

            <!-- User Menu Content (for signed-in users) -->
            <div id="menuUserContent" class="hidden">
                <!-- Personal Statistics -->
                <div class="section">
                    <h2>📊 Your Statistics</h2>
                    <div class="stats-grid">
                        <div class="stats-card">
                            <div class="stat-item">
                                <div class="stat-value" id="userTotalGenerated">0</div>
                                <div class="stat-label">Total Prompts Generated</div>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stat-item">
                                <div class="stat-value" id="userEnhanceCount">0</div>
                                <div class="stat-label">Enhance Used</div>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stat-item">
                                <div class="stat-value" id="userRemixCount">0</div>
                                <div class="stat-label">Remix Used</div>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stat-item">
                                <div class="stat-value" id="userQuotaRemaining">0</div>
                                <div class="stat-label">Prompts Remaining</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Redeem Code Section -->
                <div class="section">
                    <h2>🎟️ Redeem Code</h2>
                    <p style="margin-bottom: 16px; color: #94a3b8;">Enter your redeem code here to add more prompts.</p>
                    
                    <div class="form-grid form-grid-2">
                        <div>
                            <label for="redeemCodeInput">Redeem Code</label>
                            <input type="text" id="redeemCodeInput" placeholder="Enter your code here" style="text-transform: uppercase;"/>
                        </div>
                        <div style="display: flex; align-items: end;">
                            <button class="generate-btn" onclick="redeemCode()" style="margin: 0; width: 100%;">
                                🎁 Redeem Code
                            </button>
                        </div>
                    </div>
                    
                    <div id="redeemStatus" style="margin-top: 12px; font-size: 14px;"></div>
                </div>

                <!-- Payment UI Section -->
                <div class="section">
    <h2>💳 Buy More Prompts</h3>
    <p>Purchase additional prompts to continue generating.</p>
    <select id="quota-purchase">
        <option value="10|50000">10 Prompts - IDR 50,000</option>
        <option value="20|100000">20 Prompts - IDR 100,000</option>
        <option value="50|200000">50 Prompts - IDR 200,000</option>
    </select>
    <button onclick="initiatePayment()">Buy Now</button>
</div>

                <!-- Recent Activity -->
                <div class="section">
                    <h2>📝 Recent Activity</h2>
                    <div id="recentActivity">
                        <p style="color: #94a3b8; font-style: italic;">Loading recent activity...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Tab Content -->
        <div id="adminTab" class="tab-content">
            <div class="tab-header">
                <h2 class="tab-title">Admin Dashboard</h2>
            </div>

            <!-- Dashboard Overview -->
            <div class="admin-grid">
                <div class="admin-card">
                    <h3>📊 Platform Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="totalUsers">0</div>
                            <div class="stat-label">Total Users</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="totalPrompts">0</div>
                            <div class="stat-label">Total Prompts</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="totalEnhance">0</div>
                            <div class="stat-label">Enhance Used</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="totalRemix">0</div>
                            <div class="stat-label">Remix Used</div>
                        </div>
                    </div>
                </div>

                <div class="admin-card">
                    <h3>⚡ Today's Activity</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="todayUsers">0</div>
                            <div class="stat-label">Active Users</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="todayPrompts">0</div>
                            <div class="stat-label">Prompts Generated</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Code Management -->
            <div class="admin-card">
                <h3>🎟️ Create Redeem Code</h3>
                <div class="form-grid form-grid-3">
                    <div>
                        <label for="adminCodeInput">Code</label>
                        <input type="text" id="adminCodeInput" placeholder="e.g., WELCOME50" style="text-transform: uppercase;"/>
                    </div>
                    <div>
                        <label for="adminQuotaInput">Quota</label>
                        <input type="number" id="adminQuotaInput" placeholder="50" min="1"/>
                    </div>
                    <div>
                        <label for="adminExpiryInput">Expiry Date</label>
                        <input type="date" id="adminExpiryInput"/>
                    </div>
                </div>
                <button class="generate-btn" onclick="createCode()" style="margin-top: 16px;">
                    ✨ Create Code
                </button>
                <div id="adminCodeFeedback" style="margin-top: 12px; font-size: 14px;"></div>
            </div>

            <!-- User Management -->
            <div class="admin-card">
                <h3>👥 User Management</h3>
                
                <div class="table-actions">
                    <input type="search" id="userSearchInput" class="search-input" placeholder="Search by email or UID..." onkeyup="filterUsers()">
                    <select id="userFilterSelect" class="filter-select" onchange="filterUsers()">
                        <option value="all">All Users</option>
                        <option value="active">Active Users</option>
                        <option value="premium">Premium Users</option>
                        <option value="high-usage">High Usage</option>
                        <option value="low-quota">Low Quota</option>
                    </select>
                    <button class="copy-btn" onclick="refreshUsers()">🔄 Refresh</button>
                </div>

                <div style="overflow-x: auto;">
                    <table class="data-table" id="usersTable">
                        <thead>
                            <tr>
                                <th>Email</th>
                                <th>UID</th>
                                <th>Quota</th>
                                <th>Used Today</th>
                                <th>Last Active</th>
                                <th>Total Generated</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <tr>
                                <td colspan="7" style="text-align: center; padding: 32px; color: #94a3b8;">
                                    Loading users...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- User Lookup -->
            <div class="admin-card">
                <h3>🔍 User Lookup</h3>
                <div class="form-grid form-grid-2">
                    <div>
                        <label for="lookupEmailInput">User Email</label>
                        <input type="email" id="lookupEmailInput" placeholder="user@example.com"/>
                    </div>
                    <div style="display: flex; align-items: end;">
                        <button class="generate-btn" onclick="lookupUser()" style="margin: 0; width: 100%;">
                            🔍 Find User
                        </button>
                    </div>
                </div>
                <div id="lookupResult" style="margin-top: 16px;"></div>
            </div>
        </div>

        <!-- Contact Tab Content -->
        <div id="contactTab" class="tab-content">
            <div class="tab-header">
                <h2 class="tab-title">Contact Us</h2>
            </div>

            <!-- Contact Info -->
            <div class="contact-info">
                <h3>Get in Touch</h3>
                <p>If you have any questions or suggestions, please reach out to us!</p>
                <a href="mailto:cygryuu@gmail.com" class="contact-email">cygryuu@gmail.com</a>
            </div>

            <!-- Contact Form -->
            <div class="section">
                <h2>Send us a Message</h2>
                
                <form id="contactForm">
                    <div class="form-grid form-grid-2">
                        <div>
                            <label for="contactName">Name <span class="required-field">*</span></label>
                            <input type="text" id="contactName" placeholder="Your full name" required/>
                        </div>
                        
                        <div>
                            <label for="contactEmail">Email <span class="required-field">*</span></label>
                            <input type="email" id="contactEmail" placeholder="your.email@example.com" required/>
                        </div>
                    </div>

                    <div class="form-grid form-grid-2">
                        <div>
                            <label for="contactPhone">Phone (Optional)</label>
                            <input type="tel" id="contactPhone" placeholder="+1 (555) 123-4567"/>
                        </div>
                        
                        <div>
                            <label for="contactCategory">Category <span class="required-field">*</span></label>
                            <select id="contactCategory" required>
                                <option value="">Select a category</option>
                                <option value="bug_report">Bug Report</option>
                                <option value="feature_request">Feature Request</option>
                                <option value="general_inquiry">General Inquiry</option>
                                <option value="billing_support">Billing Support</option>
                                <option value="technical_support">Technical Support</option>
                                <option value="feedback">Feedback & Suggestions</option>
                                <option value="partnership">Partnership Inquiry</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>

                    <label for="contactSubject">Subject <span class="required-field">*</span></label>
                    <input type="text" id="contactSubject" placeholder="Brief description of your message" required/>

                    <label for="contactMessage">Message <span class="required-field">*</span></label>
                    <textarea id="contactMessage" rows="6" placeholder="Please provide details about your inquiry, issue, or feedback..." required></textarea>

                    <div class="action-buttons">
                        <button type="button" class="clear-btn" onclick="clearContactForm()">🗑️ Clear Form</button>
                        <button type="submit" class="generate-btn">📞 Send Message</button>
                    </div>
                </form>
            </div>

            <!-- Contact Success Message -->
            <div id="contactSuccessMessage" class="hidden">
                <div class="section" style="text-align: center; background: rgba(16, 185, 129, 0.1); border-color: rgba(16, 185, 129, 0.3);">
                    <h2 style="color: #10b981; margin-bottom: 16px;">✅ Message Sent Successfully!</h2>
                    <p style="color: #94a3b8; margin-bottom: 20px;">Thank you for reaching out! We'll get back to you as soon as possible.</p>
                    <button class="generate-btn" onclick="resetContactForm()">📞 Send Another Message</button>
                </div>
            </div>
        </div>

        <!-- Help Modals -->
        <div id="helpModal" class="help-modal">
            <div class="help-modal-content">
                <div class="help-modal-header">
                    <h3 class="help-modal-title" id="helpModalTitle">Help</h3>
                    <button class="help-close" onclick="closeHelp()">&times;</button>
                </div>
                <div class="help-content" id="helpModalContent">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>Developed by <strong>CygRyu</strong></p>
            <div>
                <a href="https://ko-fi.com/cygryu" target="_blank">☕ Ko-Fi</a>
                <a href="https://www.paypal.com/paypalme/sofiansu?country.x=ID&locale.x=en_US" target="_blank">💳 PayPal</a>
            </div>
        </div>
    </main>

<!-- Firebase Core SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

    <script>
        // Configuration - UPDATE THIS URL TO YOUR ACTUAL BACKEND URL
        const API_BASE_URL = "https://66f9e544-efaf-4086-a849-aefdefa94a7e-00-1ya2qyok05zo.sisko.replit.dev";

        // Global state
        let currentUser = null;
        let userStats = {};
        let adminData = {};

        // Tone options mapping
        const toneOptions = {
            emotional: ['Happy/Joyful', 'Funny/Comedic', 'Heartwarming', 'Sad/Melancholic', 'Romantic', 'Inspirational/Motivational', 'Peaceful/Calming', 'Nostalgic'],
            suspense: ['Scary/Horror', 'Mysterious', 'Suspenseful', 'Dramatic', 'Dark', 'Thriller'],
            action: ['Epic/Heroic', 'Action-Packed', 'Adventurous', 'Energetic'],
            artistic: ['Dreamy/Surreal', 'Artistic/Aesthetic', 'Experimental', 'Minimalist'],
            documentary: ['Documentary', 'Realistic', 'Gritty', 'Professional'],
            fantasy: ['Magical', 'Futuristic', 'Fantasy'],
            social: ['Trendy/Hip', 'Retro/Vintage', 'Urban', 'Rural/Country'],
            unique: ['Quirky/Weird', 'Luxurious', 'Cozy', 'Badass', 'Awkward', 'Chaotic', 'Zen/Spiritual']
        };

        // Video gallery data with your YouTube video
        const videoData = [
            {
                title: "Veo 3 Showcase Video - AI Video Generation Demo",
                url: "https://www.youtube.com/embed/MK2sbQper4M?rel=0"
            },
            {
                title: "Sample Video 2 - Advanced Settings Demo",
                url: "https://www.youtube.com/embed/PLACEHOLDER_VIDEO_ID_2"
            },
            {
                title: "Sample Video 3 - Creative Style Examples",
                url: "https://www.youtube.com/embed/PLACEHOLDER_VIDEO_ID_3"
            }
        ];

        let currentVideoIndex = {
            enhance: 0,
            remix: 0
        };

        // Mobile menu toggle
        function toggleMobileMenu() {
            const navTabs = document.getElementById('navTabs');
            navTabs.classList.toggle('show');
        }

        // User dropdown toggle
        function toggleUserDropdown() {
            const dropdownMenu = document.getElementById('dropdownMenu');
            dropdownMenu.classList.toggle('show');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const userDropdown = document.querySelector('.user-dropdown');
            const dropdownMenu = document.getElementById('dropdownMenu');
            
            if (userDropdown && !userDropdown.contains(event.target)) {
                dropdownMenu.classList.remove('show');
            }
        });

        // Tab Management
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons (desktop and mobile)
            document.querySelectorAll('.tab-button, .mobile-tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // Add active class to selected tab button (desktop)
            const desktopBtn = document.querySelector(`.tab-button[onclick="switchTab('${tabName}')"]`);
            if (desktopBtn) desktopBtn.classList.add('active');
            
            // Add active class to selected mobile tab button
            const mobileBtn = document.getElementById(`mobile${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Btn`);
            if (mobileBtn) mobileBtn.classList.add('active');

            // Close mobile menu
            document.getElementById('navTabs').classList.remove('show');

            // Load tab-specific data
            if (tabName === 'menu' && currentUser) {
                loadUserStats();
            } else if (tabName === 'admin' && isAdmin(currentUser?.uid)) {
                loadAdminData();
            } else if (tabName === 'contact' && currentUser) {
                // Auto-fill user info in contact form
                autoFillContactForm();
            }
        }

        // Authentication functions
        function signIn() {
            const signInBtn = document.getElementById('signInBtn');
            signInBtn.click();
        }

        // Contact form functions
        function autoFillContactForm() {
            if (currentUser) {
                const userName = currentUser.email ? currentUser.email.split('@')[0] : '';
                document.getElementById('contactName').value = userName;
                document.getElementById('contactEmail').value = currentUser.email || '';
            }
        }

        function clearContactForm() {
            if (confirm('Are you sure you want to clear the form?')) {
                document.getElementById('contactForm').reset();
                // Re-auto-fill if user is signed in
                if (currentUser) {
                    autoFillContactForm();
                }
            }
        }

        function resetContactForm() {
            document.getElementById('contactSuccessMessage').classList.add('hidden');
            document.getElementById('contactForm').classList.remove('hidden');
            document.getElementById('contactForm').reset();
            // Re-auto-fill if user is signed in
            if (currentUser) {
                autoFillContactForm();
            }
        }

        async function submitContactForm(formData) {
            try {
                const response = await fetch(`${API_BASE_URL}/contact`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                const result = await response.json();

                if (response.ok) {
                    // Show success message
                    document.getElementById('contactForm').classList.add('hidden');
                    document.getElementById('contactSuccessMessage').classList.remove('hidden');
                    showPopupNotification('✅ Message sent successfully!', 'success');
                } else {
                    throw new Error(result.error || 'Failed to send message');
                }
            } catch (error) {
                console.error('Contact form error:', error);
                showPopupNotification('❌ Failed to send message. Please try again.', 'error');
            }
        }

        // Remix Mode Toggle
        function toggleRemixMode() {
            const toggle = document.getElementById('remixModeToggle');
            const simpleLabel = document.getElementById('simpleLabel');
            const advancedLabel = document.getElementById('advancedLabel');
            const advancedSection = document.getElementById('remixAdvancedSection');
            
            if (toggle.checked) {
                // Advanced mode
                simpleLabel.classList.remove('active');
                simpleLabel.classList.add('inactive');
                advancedLabel.classList.remove('inactive');
                advancedLabel.classList.add('active');
                advancedSection.classList.remove('hidden');
            } else {
                // Simple mode
                advancedLabel.classList.remove('active');
                advancedLabel.classList.add('inactive');
                simpleLabel.classList.remove('inactive');
                simpleLabel.classList.add('active');
                advancedSection.classList.add('hidden');
            }
        }

        function toggleAdvanced(tabName) {
            const adv = document.getElementById(tabName + "Advanced");
            const button = event.target;
            
            if (adv.style.display === "none" || adv.style.display === "") {
                adv.style.display = "block";
                button.innerHTML = "- Advanced Parameters (Optional)";
            } else {
                adv.style.display = "none";
                button.innerHTML = "+ Advanced Parameters (Optional)";
            }
        }

        function toggleGallery(tabName) {
            const gallery = document.getElementById(tabName + "VideoGallery");
            const placeholder = document.getElementById(tabName + "GalleryPlaceholder");
            const button = event.target;
            
            if (gallery.style.display === "none" || gallery.style.display === "") {
                gallery.style.display = "block";
                placeholder.style.display = "none";
                button.innerHTML = "- Sample Gallery";
                loadVideo(tabName, currentVideoIndex[tabName]);
            } else {
                gallery.style.display = "none";
                placeholder.style.display = "block";
                button.innerHTML = "+ Sample Gallery";
            }
        }

        function loadVideo(tabName, index) {
            if (index >= 0 && index < videoData.length) {
                const video = videoData[index];
                document.getElementById(tabName + "VideoFrame").src = video.url;
                document.getElementById(tabName + "VideoTitle").textContent = video.title;
                document.getElementById(tabName + "VideoCounter").textContent = `${index + 1} / ${videoData.length}`;
                
                // Update navigation buttons
                document.getElementById(tabName + "PrevBtn").disabled = index === 0;
                document.getElementById(tabName + "NextBtn").disabled = index === videoData.length - 1;
                
                currentVideoIndex[tabName] = index;
            }
        }

        function previousVideo(tabName) {
            if (currentVideoIndex[tabName] > 0) {
                loadVideo(tabName, currentVideoIndex[tabName] - 1);
            }
        }

        function nextVideo(tabName) {
            if (currentVideoIndex[tabName] < videoData.length - 1) {
                loadVideo(tabName, currentVideoIndex[tabName] + 1);
            }
        }

        function updateSubTones(tabName) {
            const prefix = tabName === 'enhance' ? '' : 'remix';
            const generalToneId = prefix ? prefix + 'GeneralTone' : 'generalTone';
            const subToneId = prefix ? prefix + 'SubTone' : 'subTone';
            
            const generalTone = document.getElementById(generalToneId).value;
            const subToneSelect = document.getElementById(subToneId);
            
            // Clear existing options
            subToneSelect.innerHTML = '<option value="">Auto Detect</option>';
            
            if (generalTone && toneOptions[generalTone]) {
                toneOptions[generalTone].forEach(tone => {
                    const option = document.createElement('option');
                    option.value = tone;
                    option.textContent = tone;
                    subToneSelect.appendChild(option);
                });
            }
        }

        function updateSliderValue(sliderId) {
            const slider = document.getElementById(sliderId);
            const valueSpan = document.getElementById(sliderId + 'Value');
            valueSpan.textContent = slider.value + '%';
        }

        function showError(message) {
            // Remove existing error messages
            const existingErrors = document.querySelectorAll('.error-message');
            existingErrors.forEach(error => error.remove());
            
            // Create new error message
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            
            // Insert in current active tab
            const activeTab = document.querySelector('.tab-content.active');
            const firstSection = activeTab.querySelector('.section');
            firstSection.parentNode.insertBefore(errorDiv, firstSection.nextSibling);
            
            // Scroll to error
            errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Clear form function
        function clearForm(tabName) {
            if (confirm('Are you sure you want to clear all fields? This action cannot be undone.')) {
                if (tabName === 'enhance') {
                    // Clear enhance form
                    document.getElementById('description').value = '';
                    document.getElementById('subject').value = '';
                    document.getElementById('action').selectedIndex = 0;
                    document.getElementById('style').selectedIndex = 0;
                    document.getElementById('generalTone').selectedIndex = 0;
                    document.getElementById('subTone').selectedIndex = 0;
                    document.getElementById('aspectRatio').selectedIndex = 0;
                    document.getElementById('cameraMovement').selectedIndex = 0;
                    document.getElementById('cameraLevel').selectedIndex = 0;
                    document.getElementById('lensType').selectedIndex = 0;
                    document.getElementById('depthOfField').selectedIndex = 0;
                    document.getElementById('lighting').selectedIndex = 0;
                    document.getElementById('filmGrain').value = 0;
                    updateSliderValue('filmGrain');
                    document.getElementById('chromaticAberration').value = 0;
                    updateSliderValue('chromaticAberration');
                    document.getElementById('environment').selectedIndex = 0;
                    document.getElementById('colorPalette').selectedIndex = 0;
                    document.getElementById('weather').selectedIndex = 0;
                    document.getElementById('timeOfDay').selectedIndex = 0;
                    document.getElementById('motionIntensity').selectedIndex = 0;
                    document.getElementById('moodEmotion').selectedIndex = 0;
                    document.getElementById('dialogue').value = '';
                    
                    // Hide output section
                    document.getElementById('enhanceOutputSection').classList.add('hidden');
                } else {
                    // Clear remix form
                    document.getElementById('originalPrompt').value = '';
                    document.getElementById('variationInstructions').value = '';
                    
                    // Reset toggle to simple mode
                    document.getElementById('remixModeToggle').checked = false;
                    toggleRemixMode();
                    
                    // Clear advanced fields
                    document.getElementById('remixSubject').value = '';
                    document.getElementById('remixAction').selectedIndex = 0;
                    document.getElementById('remixStyle').selectedIndex = 0;
                    document.getElementById('remixGeneralTone').selectedIndex = 0;
                    document.getElementById('remixSubTone').selectedIndex = 0;
                    document.getElementById('remixAspectRatio').selectedIndex = 0;
                    document.getElementById('remixCameraMovement').selectedIndex = 0;
                    document.getElementById('remixCameraLevel').selectedIndex = 0;
                    document.getElementById('remixLensType').selectedIndex = 0;
                    document.getElementById('remixDepthOfField').selectedIndex = 0;
                    document.getElementById('remixLighting').selectedIndex = 0;
                    document.getElementById('remixFilmGrain').value = 0;
                    updateSliderValue('remixFilmGrain');
                    document.getElementById('remixChromaticAberration').value = 0;
                    updateSliderValue('remixChromaticAberration');
                    document.getElementById('remixEnvironment').selectedIndex = 0;
                    document.getElementById('remixColorPalette').selectedIndex = 0;
                    document.getElementById('remixWeather').selectedIndex = 0;
                    document.getElementById('remixTimeOfDay').selectedIndex = 0;
                    document.getElementById('remixMotionIntensity').selectedIndex = 0;
                    document.getElementById('remixMoodEmotion').selectedIndex = 0;
                    document.getElementById('remixDialogue').value = '';
                    
                    // Hide output section
                    document.getElementById('remixOutputSection').classList.add('hidden');
                }
                
                // Remove any existing error messages
                const existingErrors = document.querySelectorAll('.error-message');
                existingErrors.forEach(error => error.remove());
            }
        }

        // Help modal functions
        function showHelp(tabName) {
            const modal = document.getElementById('helpModal');
            const title = document.getElementById('helpModalTitle');
            const content = document.getElementById('helpModalContent');
            
            if (tabName === 'enhance') {
                title.textContent = 'Enhance Tab - Best Practices';
                content.innerHTML = `
                    <h4>🎯 What is the Enhance Feature?</h4>
                    <p>The Enhance feature transforms your basic prompt idea into a detailed, professional-quality Veo 3 prompt with rich cinematographic details, structured formatting, and technical specifications optimized for AI video generation.</p>
                    
                    <h4>📝 How to Use Effectively:</h4>
                    <ul>
                        <li><strong>Start Simple:</strong> Enter a basic description in "Your Prompt" field (e.g., "A cat flying through a city")</li>
                        <li><strong>Add Context:</strong> Use Subject and Action fields to specify key elements and movements</li>
                        <li><strong>Choose Style:</strong> Select from 40+ video styles including Cinematic, Documentary, Animation, VHS, etc.</li>
			<li><strong>Set Tone:</strong> Pick from 8 general tone categories with specific sub-tones for precise mood control</li>
                        <li><strong>Advanced Parameters:</strong> Fine-tune camera movement, lighting, visual effects, environment, and atmosphere</li>
    			<li><strong>Include Dialogue:</strong> Add specific dialogue in quotes - the AI will preserve exact wording and add proper formatting</li>
                    </ul>
                    
                    <h4>💡 Pro Tips:</h4>
                    <ul>
                        <li><strong>Start Broad:</strong> Even vague prompts work well - the AI will add professional details</li>
		        <li><strong>Control Tips:</strong> But if you want more control in output result, feel free to be as detailed as possible</li>
		        <li><strong>Mix Styles:</strong> Combine different elements for unique results (e.g., "Horror + Documentary")</li>
                        <li><strong>Use Auto Detect:</strong> Let AI choose optimal settings when unsure</li>
			<li><strong>Dialogue Precision:</strong> The AI preserves exact dialogue wording and adds proper tone descriptions</li>
			<li><strong>Technical Quality:</strong> Generated prompts include professional terminology for lighting, camera work, and audio design</li>
                    </ul>
                    
                    <div class="example">
    <strong>Example Enhancement:</strong><br>
    <strong>Input:</strong> "A robot serving coffee"<br>
    <strong>Enhanced Output:</strong><br>
    "Medium shot. Subject: A sleek, humanoid robot with polished chrome exterior and gentle blue LED eyes, wearing a vintage coffee shop apron, carefully operating a professional espresso machine. Scene: Modern café interior with warm wood furnishings, exposed brick walls, and soft natural light filtering through large windows. Action: The robot methodically steams milk with precise movements, creating perfect microfoam while maintaining eye contact with an off-camera customer. Style: Cinematic, high-definition with warm color grading and shallow depth of field. Audio: Gentle hiss of the espresso machine, subtle café ambiance, and the robot's soft mechanical whirring. --ar 16:9"
</div>
                `;
            } else {
                title.textContent = 'Remix Tab - Best Practices';
                content.innerHTML = `
                    <h4>🎛️ What is the Remix Feature?</h4>
                    <p>The Remix feature takes any existing prompt (from social media, other generators, or previous creations) and creates intelligent variations based on your specific instructions. Perfect for adapting viral prompts, exploring creative alternatives, or fine-tuning existing concepts. 
(PS: It also enhances the output prompt automatically. How cool is that?)</p>
                    
                    <h4>📝 How to Use Effectively:</h4>
                    <ul>
                        <li><strong>Paste Original:</strong> Copy any existing prompt into "Original Prompt" field</li>
                        <li><strong>Specify Changes:</strong> Clearly describe modifications in "How to Vary This Prompt" field</li>
                        <li><strong>Choose Mode:</strong> Toggle between Simple and Advanced remix modes</li>
                        <li><strong>Be Specific:</strong> The more detailed your variation instructions, the more precise the output</li>
                    </ul>
                    
                    <h4>🔀 Simple vs Advanced Mode:</h4>
<ul>
    <li><strong>Simple Mode:</strong> 
        <ul>
            <li>Uses only your variation instructions and the original prompt</li>
            <li>Maintains original structure and style elements where possible</li>
            <li>Best for quick character swaps, setting changes, or mood shifts</li>
        </ul>
    </li>
    <li><strong>Advanced Mode:</strong>
        <ul>
            <li>Combines variation instructions with all technical parameters</li>
            <li>Complete reconstruction using both original concept and new specifications</li>
            <li>Best for comprehensive reimagining with technical precision</li>
        </ul>
    </li>
</ul>
                    
                    <h4>💡 Pro Remix Tips:</h4>
<ul>
    <li><strong>Viral Adaptation:</strong> Take trending prompts and add your unique twist</li>
    <li><strong>Incremental Changes:</strong> Change one element at a time for controlled experimentation</li>
    <li><strong>Genre Hopping:</strong> Transform realistic prompts to fantasy, horror to comedy, etc.</li>
    <li><strong>Technical Enhancement:</strong> Use Advanced mode to add professional cinematography to simple prompts</li>
    <li><strong>Dialogue Integration:</strong> Add character voices and specific lines to existing visual prompts</li>
    <li><strong>Creative Conflicts:</strong> Intentionally mix contradictory elements for surprising artistic results</li>
</ul>
                    
                    <div class="example">
    <strong>Advanced Mode Example:</strong><br>
    <strong>Original:</strong> "A towering creature resembling a pine tree with multiple glowing eyes stands still in the dense forest fog. The camera slowly zooms in from a handheld perspective behind the trees. Add light wind, distant bird cries, and subtle whisper-like sounds. Cold green-gray palette with fog particles and grain. 8 seconds, unsettling and meditative."<br>
    <strong>Variation:</strong> "Change the creature to a towering spider with multiple eyes and sharp mandibles. Continuously sprouting web that traps nearby running people. People are screaming."<br>
    <strong>Advanced Parameters:</strong> "Video Style: Analog/Film Grain, Time of Day: Dusk"<br>
    <strong>Result:</strong> "The camera adopts a handheld perspective, weaving through densely packed trees in a fog-laden forest at dusk, capturing the unsettling sight of a towering spider-like creature. This arachnid behemoth, with multiple glowing eyes and sharp, menacing mandibles, stands ominously amidst the swirling mist, its bulk partially obscured by the drifting fog. As the lens zooms in slowly, the creature continuously spins vast webs from its abdomen, trapping nearby people desperately fleeing through..." 
</div>
                `;
            }
            
            modal.style.display = 'block';
        }

        function closeHelp() {
            document.getElementById('helpModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('helpModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        async function generatePrompt() {
            console.log("Generate function called");
            
            // Validate description field
            const description = document.getElementById("description").value.trim();
            if (!description) {
                showError("Please enter a prompt description before generating.");
                return;
            }
            
            // Check if user is logged in
            if (!window.currentUID) {
                showError("Please sign in to use this feature.");
                return;
            }
            
            // Remove any existing error messages
            const existingErrors = document.querySelectorAll('.error-message');
            existingErrors.forEach(error => error.remove());

            const user = firebase.auth().currentUser;
            const userEmail = user ? user.email : "";

            const payload = {
                uid: window.currentUID,
                email: userEmail,
                description: description,
                subject: document.getElementById("subject").value,
                action: document.getElementById("action").value,
                style: document.getElementById("style").value,
                generalTone: document.getElementById("generalTone").value,
                subTone: document.getElementById("subTone").value,
                aspectRatio: document.getElementById("aspectRatio").value,
                cameraMovement: document.getElementById("cameraMovement").value,
                cameraLevel: document.getElementById("cameraLevel").value,
                lensType: document.getElementById("lensType").value,
                depthOfField: document.getElementById("depthOfField").value,
                lighting: document.getElementById("lighting").value,
                filmGrain: document.getElementById("filmGrain").value,
                chromaticAberration: document.getElementById("chromaticAberration").value,
                environment: document.getElementById("environment").value,
                colorPalette: document.getElementById("colorPalette").value,
                weather: document.getElementById("weather").value,
                timeOfDay: document.getElementById("timeOfDay").value,
                motionIntensity: document.getElementById("motionIntensity").value,
                moodEmotion: document.getElementById("moodEmotion").value,
                dialogue: document.getElementById("dialogue").value
            };

            console.log("Sending payload:", payload);

            document.getElementById("enhanceOutput").innerText = "⏳ Generating...";
            document.getElementById("enhanceOutputSection").classList.remove("hidden");

            try {
                const response = await fetch(`${API_BASE_URL}/generate`, {
                    method: "POST",
                    headers: { 
                        "Content-Type": "application/json",
                        "Accept": "application/json"
                    },
                    body: JSON.stringify(payload)
                });

                console.log("Response status:", response.status);
                
                const data = await response.json();
                console.log("Response data:", data);
                
                if (response.ok && data.prompt) {
                    document.getElementById("enhanceOutput").innerText = data.prompt;
                    await updateQuotaCounter();
                    if (currentUser) {
                        loadUserStats(); // Refresh stats
                    }
                } else {
                    showError(data.error || "Server error occurred.");
                    document.getElementById("enhanceOutputSection").classList.add("hidden");
                }
            } catch (error) {
                console.error('Network error:', error);
                showError("Error connecting to server. Please check your internet connection and try again.");
                document.getElementById("enhanceOutputSection").classList.add("hidden");
            }
        }

        async function remixPrompt() {
            console.log("Remix function called");
            
            // Validate required fields
            const originalPrompt = document.getElementById("originalPrompt").value.trim();
            const variationInstructions = document.getElementById("variationInstructions").value.trim();
            
            if (!originalPrompt) {
                showError("Please enter an original prompt to remix.");
                return;
            }
            
            if (!variationInstructions) {
                showError("Please specify how you want to vary the prompt.");
                return;
            }
            
            // Check if user is logged in
            if (!window.currentUID) {
                showError("Please sign in to use this feature.");
                return;
            }
            
            // Remove any existing error messages
            const existingErrors = document.querySelectorAll('.error-message');
            existingErrors.forEach(error => error.remove());

            const user = firebase.auth().currentUser;
            const userEmail = user ? user.email : "";

            const isAdvancedMode = document.getElementById('remixModeToggle').checked;
            
            const payload = {
                uid: window.currentUID,
                email: userEmail,
                originalPrompt: originalPrompt,
                variationInstructions: variationInstructions,
                remixMode: isAdvancedMode ? "advanced" : "simple"
            };

            // Add advanced parameters if in advanced mode
            if (isAdvancedMode) {
                payload.subject = document.getElementById("remixSubject").value;
                payload.action = document.getElementById("remixAction").value;
                payload.style = document.getElementById("remixStyle").value;
                payload.generalTone = document.getElementById("remixGeneralTone").value;
                payload.subTone = document.getElementById("remixSubTone").value;
                payload.aspectRatio = document.getElementById("remixAspectRatio").value;
                payload.cameraMovement = document.getElementById("remixCameraMovement").value;
                payload.cameraLevel = document.getElementById("remixCameraLevel").value;
                payload.lensType = document.getElementById("remixLensType").value;
                payload.depthOfField = document.getElementById("remixDepthOfField").value;
                payload.lighting = document.getElementById("remixLighting").value;
                payload.filmGrain = document.getElementById("remixFilmGrain").value;
                payload.chromaticAberration = document.getElementById("remixChromaticAberration").value;
                payload.environment = document.getElementById("remixEnvironment").value;
                payload.colorPalette = document.getElementById("remixColorPalette").value;
                payload.weather = document.getElementById("remixWeather").value;
                payload.timeOfDay = document.getElementById("remixTimeOfDay").value;
                payload.motionIntensity = document.getElementById("remixMotionIntensity").value;
                payload.moodEmotion = document.getElementById("remixMoodEmotion").value;
                payload.dialogue = document.getElementById("remixDialogue").value;
            }

            console.log("Sending remix payload:", payload);

            document.getElementById("remixOutput").innerText = "⏳ Remixing...";
            document.getElementById("remixOutputSection").classList.remove("hidden");

            try {
                const response = await fetch(`${API_BASE_URL}/remix`, {
                    method: "POST",
                    headers: { 
                        "Content-Type": "application/json",
                        "Accept": "application/json"
                    },
                    body: JSON.stringify(payload)
                });

                console.log("Remix response status:", response.status);

                const data = await response.json();
                console.log("Remix response data:", data);
                
                if (response.ok && data.prompt) {
                    document.getElementById("remixOutput").innerText = data.prompt;
                    await updateQuotaCounter();
                    if (currentUser) {
                        loadUserStats(); // Refresh stats
                    }
                } else {
                    showError(data.error || "Server error occurred.");
                    document.getElementById("remixOutputSection").classList.add("hidden");
                }
            } catch (error) {
                console.error('Network error:', error);
                showError("Error connecting to server. Please check your internet connection and try again.");
                document.getElementById("remixOutputSection").classList.add("hidden");
            }
        }

        function copyPrompt(outputId) {
            const output = document.getElementById(outputId);
            const text = output.textContent;
            
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(text).then(() => {
                    showCopyFeedback();
                }).catch(err => {
                    console.error('Failed to copy:', err);
                    fallbackCopyTextToClipboard(text);
                });
            } else {
                fallbackCopyTextToClipboard(text);
            }
        }

        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-999999px";
            textArea.style.top = "-999999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showCopyFeedback();
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
            }
            
            document.body.removeChild(textArea);
        }

        function showCopyFeedback() {
            // Show popup notification
            showPopupNotification('✅ Copied to clipboard!', 'success');
            
            // Also change button text briefly
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '✅ Copied!';
            const originalBg = button.style.backgroundColor;
            button.style.background = 'linear-gradient(135deg, #10b981, #059669)';
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.style.background = originalBg;
            }, 2000);
        }

        function showPopupNotification(message, type = 'success') {
            // Remove any existing popup
            const existingPopup = document.querySelector('.popup-notification');
            if (existingPopup) {
                existingPopup.remove();
            }

            // Create new popup
            const popup = document.createElement('div');
            popup.className = `popup-notification ${type}`;
            popup.textContent = message;
            
            // Add to body
            document.body.appendChild(popup);
            
            // Trigger animation
            setTimeout(() => {
                popup.classList.add('show');
            }, 10);
            
            // Remove after delay (3.5s)
            setTimeout(() => {
                popup.classList.remove('show');
                setTimeout(() => {
                    if (popup.parentNode) {
                        popup.remove();
                    }
                }, 400);
            }, 3500);
        }

        async function updateQuotaCounter() {
            if (!window.currentUID) return;

            try {
                const response = await fetch(`${API_BASE_URL}/get-quota`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: window.currentUID })
                });

                const data = await response.json();
                if (data.quota !== undefined) {
                    const quotaDisplay = document.getElementById("quotaDisplay");
                    if (quotaDisplay) {
                        quotaDisplay.textContent = `🎟️ ${data.quota} prompts left`;
                    }
                    
                    // Update menu stats if visible
                    const userQuotaRemaining = document.getElementById("userQuotaRemaining");
                    if (userQuotaRemaining) {
                        userQuotaRemaining.textContent = data.quota;
                    }
                }
            } catch (e) {
                console.error("Quota fetch failed:", e);
            }
        }

        // Menu tab functions
        async function loadUserStats() {
            if (!window.currentUID) return;

            try {
                const response = await fetch(`${API_BASE_URL}/user-stats`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: window.currentUID })
                });

                const data = await response.json();
                if (response.ok) {
                    userStats = data;
                    
                    // Update stats display
                    document.getElementById("userTotalGenerated").textContent = data.totalGenerated || 0;
                    document.getElementById("userEnhanceCount").textContent = data.enhanceCount || 0;
                    document.getElementById("userRemixCount").textContent = data.remixCount || 0;
                    document.getElementById("userQuotaRemaining").textContent = data.quota || 0;
                    
                    // Update recent activity
                    const recentActivity = document.getElementById("recentActivity");
                    if (data.recentActivity && data.recentActivity.length > 0) {
                        recentActivity.innerHTML = data.recentActivity.map(activity => `
                            <div style="padding: 8px; border-bottom: 1px solid rgba(99, 102, 241, 0.2);">
                                <strong>${activity.type}</strong> - ${activity.date}
                            </div>
                        `).join('');
                    } else {
                        recentActivity.innerHTML = '<p style="color: #94a3b8; font-style: italic;">No recent activity</p>';
                    }
                }
            } catch (error) {
                console.error("Failed to load user stats:", error);
            }
        }

        // Redeem code function
        async function redeemCode() {
            const code = document.getElementById('redeemCodeInput').value.trim();
            const uid = window.currentUID;
            const user = firebase.auth().currentUser;

            if (!uid || !code || !user || !user.email) {
                showPopupNotification("❌ Please enter a code and sign in.", 'error');
                return;
            }

            const redeemStatus = document.getElementById('redeemStatus');
            redeemStatus.innerHTML = '⏳ Redeeming code...';

            try {
                const response = await fetch(`${API_BASE_URL}/redeem-code`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid, code, email: user.email })
                });

                const data = await response.json();
                if (data.success) {
                    showPopupNotification(`✅ Code redeemed! +${data.added} prompts added.`, 'success');
                    document.getElementById('redeemCodeInput').value = '';
                    redeemStatus.innerHTML = `<span style="color: #10b981;">✅ Successfully redeemed! +${data.added} prompts added.</span>`;
                    await updateQuotaCounter();
                    loadUserStats(); // Refresh stats
                } else {
                    showPopupNotification(`❌ ${data.error}`, 'error');
                    redeemStatus.innerHTML = `<span style="color: #ef4444;">❌ ${data.error}</span>`;
                }
            } catch (err) {
                console.error("Redeem failed", err);
                showPopupNotification("⚠️ Network error", 'warning');
                redeemStatus.innerHTML = '<span style="color: #f59e0b;">⚠️ Network error. Please try again.</span>';
            }
        }

        // Admin functions
        function isAdmin(uid) {
            const ADMIN_UIDS = ["9n0qDAZ5xYOYmoBpcpbdvgv13I42"];
            return ADMIN_UIDS.includes(uid);
        }

        async function loadAdminData() {
            if (!window.currentUID || !isAdmin(window.currentUID)) return;

            try {
                const response = await fetch(`${API_BASE_URL}/admin-stats`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: window.currentUID })
                });

                const data = await response.json();
                if (response.ok) {
                    adminData = data;
                    
                    // Update admin stats display
                    document.getElementById("totalUsers").textContent = data.totalUsers || 0;
                    document.getElementById("totalPrompts").textContent = data.totalPrompts || 0;
                    document.getElementById("totalEnhance").textContent = data.totalEnhance || 0;
                    document.getElementById("totalRemix").textContent = data.totalRemix || 0;
                    document.getElementById("todayUsers").textContent = data.todayUsers || 0;
                    document.getElementById("todayPrompts").textContent = data.todayPrompts || 0;
                    
                    // Load users table
                    loadUsersTable();
                }
            } catch (error) {
                console.error("Failed to load admin data:", error);
            }
        }

        async function loadUsersTable() {
            if (!window.currentUID || !isAdmin(window.currentUID)) return;

            try {
                const response = await fetch(`${API_BASE_URL}/admin-users`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: window.currentUID })
                });

                const data = await response.json();
                if (response.ok && data.users) {
                    const tbody = document.getElementById('usersTableBody');
                    tbody.innerHTML = data.users.map(user => `
                        <tr>
                            <td style="color: #e2e8f0;">${user.email || 'N/A'}</td>
                            <td style="font-family: monospace; font-size: 12px; color: #e2e8f0;">${user.uid}</td>
                            <td style="color: #e2e8f0;">${user.quota || 0}</td>
                            <td style="color: #e2e8f0;">${user.usedToday || 0}</td>
                            <td style="color: #e2e8f0;">${user.lastUseDate || 'Never'}</td>
                            <td style="color: #e2e8f0;">${user.totalGenerated || 0}</td>
                            <td>
                                <button class="copy-btn" onclick="viewUserDetails('${user.uid}')" style="margin: 0;">View</button>
                            </td>
                        </tr>
                    `).join('');
                }
            } catch (error) {
                console.error("Failed to load users table:", error);
            }
        }

        function filterUsers() {
            // Simple client-side filtering - could be enhanced with server-side filtering
            const searchTerm = document.getElementById('userSearchInput').value.toLowerCase();
            const filterType = document.getElementById('userFilterSelect').value;
            const rows = document.querySelectorAll('#usersTableBody tr');

            rows.forEach(row => {
                const email = row.children[0].textContent.toLowerCase();
                const uid = row.children[1].textContent.toLowerCase();
                const quota = parseInt(row.children[2].textContent);
                const usedToday = parseInt(row.children[3].textContent);

                let showRow = true;

                // Text search
                if (searchTerm && !email.includes(searchTerm) && !uid.includes(searchTerm)) {
                    showRow = false;
                }

                // Filter by type
                if (filterType !== 'all') {
                    switch (filterType) {
                        case 'active':
                            if (usedToday === 0) showRow = false;
                            break;
                        case 'premium':
                            // Assuming premium users have > 50 quota
                            if (quota <= 50) showRow = false;
                            break;
                        case 'high-usage':
                            if (usedToday < 5) showRow = false;
                            break;
                        case 'low-quota':
                            if (quota > 10) showRow = false;
                            break;
                    }
                }

                row.style.display = showRow ? '' : 'none';
            });
        }

        function refreshUsers() {
            loadUsersTable();
        }

        async function createCode() {
            const code = document.getElementById('adminCodeInput').value.trim().toUpperCase();
            const quota = parseInt(document.getElementById('adminQuotaInput').value.trim());
            const expires = document.getElementById('adminExpiryInput').value;

            if (!code || !quota || !expires) {
                showPopupNotification("❌ All fields are required.", 'error');
                return;
            }

            const feedback = document.getElementById('adminCodeFeedback');
            feedback.innerHTML = '⏳ Creating code...';

            try {
                const response = await fetch(`${API_BASE_URL}/create-code`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ code, quota, expires, uid: window.currentUID })
                });

                const data = await response.json();
                if (data.success) {
                    showPopupNotification("✅ Code created successfully!", 'success');
                    feedback.innerHTML = `<span style="color: #10b981;">✅ Code "${code}" created successfully!</span>`;
                    
                    // Clear form
                    document.getElementById('adminCodeInput').value = '';
                    document.getElementById('adminQuotaInput').value = '';
                    document.getElementById('adminExpiryInput').value = '';
                } else {
                    showPopupNotification("❌ " + data.error, 'error');
                    feedback.innerHTML = `<span style="color: #ef4444;">❌ ${data.error}</span>`;
                }
            } catch (err) {
                console.error("Error creating code:", err);
                showPopupNotification("⚠️ Network error.", 'warning');
                feedback.innerHTML = '<span style="color: #f59e0b;">⚠️ Network error. Please try again.</span>';
            }
        }

        async function lookupUser() {
            const email = document.getElementById('lookupEmailInput').value.trim().toLowerCase();
            const resultDiv = document.getElementById('lookupResult');

            if (!email) {
                showPopupNotification("⚠️ Please enter an email.", 'warning');
                return;
            }

            resultDiv.innerHTML = '⏳ Looking up user...';

            try {
                const response = await fetch(`${API_BASE_URL}/email-to-uid`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: window.currentUID, email })
                });

                const lookup = await response.json();

                if (!lookup.found) {
                    resultDiv.innerHTML = `<span style="color: #ef4444;">❌ No user found for email: ${email}</span>`;
                    return;
                }

                // Now fetch user details
                const historyResponse = await fetch(`${API_BASE_URL}/user-history`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: window.currentUID, target: lookup.uid })
                });

                const data = await historyResponse.json();

                if (data.error) {
                    resultDiv.innerHTML = `<span style="color: #ef4444;">❌ ${data.error}</span>`;
                } else {
                    const codesHtml = data.redeemedCodes && data.redeemedCodes.length > 0 
                        ? data.redeemedCodes.map(codeInfo => `<li>${codeInfo.code} (+${codeInfo.quota} quota, used: ${codeInfo.usedAt})</li>`).join("")
                        : '<li>No codes redeemed</li>';
                        
                    resultDiv.innerHTML = `
                        <div style="background: rgba(30, 32, 42, 0.8); padding: 16px; border-radius: 8px; border: 1px solid rgba(99, 102, 241, 0.3); color: #e2e8f0;">
                            <h4 style="margin-top: 0; color: #e2e8f0;">User Details</h4>
                            <p><strong>Email:</strong> ${data.email}</p>
                            <p><strong>UID:</strong> <code style="font-size: 12px; background: rgba(15, 16, 25, 0.6); padding: 2px 4px; border-radius: 4px;">${lookup.uid}</code></p>
                            <p><strong>Current Quota:</strong> ${data.quota}</p>
                            <p><strong>Used Today:</strong> ${data.usedToday}</p>
                            <p><strong>Last Use:</strong> ${data.lastUseDate}</p>
                            <p><strong>Premium:</strong> ${data.isPremium ? 'Yes' : 'No'}</p>
                            <p><strong>Redeemed Codes:</strong></p>
                            <ul style="margin-left: 20px;">${codesHtml}</ul>
                        </div>
                    `;
                }
            } catch (err) {
                console.error("User lookup failed:", err);
                resultDiv.innerHTML = `<span style="color: #ef4444;">⚠️ Network error</span>`;
            }
        }

        function viewUserDetails(uid) {
            // Could open a modal or navigate to detailed user view
            console.log("View details for user:", uid);
            showPopupNotification("Feature coming soon!", 'warning');
        }

document.addEventListener("DOMContentLoaded", () => {
  // Collapse Advanced sections by default
  document.getElementById("enhanceAdvanced").style.display = "none";
  document.getElementById("remixAdvanced").style.display = "none";
  document.getElementById("enhanceVideoGallery").style.display = "none";
  document.getElementById("remixVideoGallery").style.display = "none";

  // Firebase Auth
  const firebaseConfig = {
    apiKey: "AIzaSyAaj5OXxoFaWkv9potb0eAV75Zl8oV4Iu0",
    authDomain: "veo3-generator-3aa92.firebaseapp.com",
    projectId: "veo3-generator-3aa92",
    storageBucket: "veo3-generator-3aa92.firebasestorage.app",
    messagingSenderId: "96789033293",
    appId: "1:96789033293:web:408853c3ce51c353458704"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const provider = new firebase.auth.GoogleAuthProvider();

// Function to initiate payment
async function initiatePayment() {
    const user = auth.currentUser;
    if (!user) {
        alert("Please sign in to purchase prompts.");
        return;
    }

    const quotaSelect = document.getElementById("quota-purchase").value.split("|");
    const quota = parseInt(quotaSelect[0]);
    const amount = parseInt(quotaSelect[1]);

    try {
        const response = await fetch("/create-payment", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                uid: user.uid,
                email: user.email,
                amount: amount,
                quota: quota
            })
        });

        const data = await response.json();
        if (data.error) {
            alert(data.error);
            return;
        }

        // Launch Midtrans Snap popup
        window.snap.pay(data.snap_token, {
            onSuccess: function (result) {
                console.log("Payment success:", result);
                alert("Payment successful! Your prompts have been added.");
                updateQuotaDisplay();
            },
            onPending: function (result) {
                console.log("Payment pending:", result);
                alert("Payment is pending. You'll receive your prompts once confirmed.");
            },
            onError: function (result) {
                console.log("Payment error:", result);
                alert("Payment failed. Please try again.");
            },
            onClose: function () {
                console.log("Payment popup closed");
                alert("Payment was not completed.");
            }
        });
    } catch (error) {
        console.error("Error initiating payment:", error);
        alert("An error occurred. Please try again.");
    }
}

// Function to update quota display
async function updateQuotaDisplay() {
    const user = auth.currentUser;
    if (user) {
        const response = await fetch("/get-quota", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ uid: user.uid })
        });
        const data = await response.json();
        document.querySelector(".prompts-remaining").textContent = `${data.quota} Prompts Remaining`;
    }
}

// Call updateQuotaDisplay on page load
auth.onAuthStateChanged((user) => {
    if (user) {
        updateQuotaDisplay();
    }
});

  // Elements
  const guestAuth = document.getElementById("guestAuth");
  const userDropdown = document.getElementById("userDropdown");
  const signInBtn = document.getElementById("signInBtn");
  const signOutBtn = document.getElementById("signOutBtn");
  const menuSignInPrompt = document.getElementById("menuSignInPrompt");
  const menuUserContent = document.getElementById("menuUserContent");
  const adminTabBtn = document.getElementById("adminTabBtn");
  const mobileAdminBtn = document.getElementById("mobileAdminBtn");

  // Contact form handler
  const contactForm = document.getElementById("contactForm");
  contactForm.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const formData = {
      name: document.getElementById('contactName').value.trim(),
      email: document.getElementById('contactEmail').value.trim(),
      phone: document.getElementById('contactPhone').value.trim() || null,
      category: document.getElementById('contactCategory').value,
      subject: document.getElementById('contactSubject').value.trim(),
      message: document.getElementById('contactMessage').value.trim(),
      userUid: window.currentUID || null,
      timestamp: new Date().toISOString()
    };

    // Basic validation
    if (!formData.name || !formData.email || !formData.category || !formData.subject || !formData.message) {
      showPopupNotification('❌ Please fill in all required fields.', 'error');
      return;
    }

    // Submit the form
    await submitContactForm(formData);
  });

  // Sign in handler
  signInBtn.addEventListener("click", async () => {
    try {
      const result = await auth.signInWithPopup(provider);
      console.log("User signed in:", result.user);
    } catch (error) {
      console.error("Login error:", error);
      showPopupNotification(`Login failed: ${error.message}`, 'error');
    }
  });

  // Sign out handler
  signOutBtn.addEventListener("click", async () => {
    try {
      await auth.signOut();
      console.log("User signed out");
    } catch (error) {
      console.error("Logout error:", error);
      showPopupNotification(`Logout failed: ${error.message}`, 'error');
    }
  });

  // Auth state observer
  auth.onAuthStateChanged(async (user) => {
    currentUser = user;
    
    if (user) {
      // User signed in
      window.currentUID = user.uid;
      
      // Update UI for signed-in state
      guestAuth.classList.add('hidden');
      userDropdown.classList.remove('hidden');
      menuSignInPrompt.classList.add('hidden');
      menuUserContent.classList.remove('hidden');
      
      // Update user info
      const username = user.email.split("@")[0];
      document.getElementById("userName").textContent = username;
      document.getElementById("userEmail").textContent = user.email;
      document.getElementById("userAvatar").textContent = username.charAt(0).toUpperCase();
      
      // Show admin tab if admin
      if (isAdmin(user.uid)) {
        adminTabBtn.classList.remove('hidden');
        mobileAdminBtn.classList.remove('hidden');
      }
      
      // Load user data
      await updateQuotaCounter();
      console.log("Your UID:", user.uid);
      
      // Auto-fill contact form if on contact tab
      if (document.getElementById('contactTab').classList.contains('active')) {
        autoFillContactForm();
      }
      
    } else {
      // User signed out
      window.currentUID = null;
      currentUser = null;
      
      // Update UI for guest state
      guestAuth.classList.remove('hidden');
      userDropdown.classList.add('hidden');
      menuSignInPrompt.classList.remove('hidden');
      menuUserContent.classList.add('hidden');
      adminTabBtn.classList.add('hidden');
      mobileAdminBtn.classList.add('hidden');
      
      // Close dropdown if open
      document.getElementById('dropdownMenu').classList.remove('show');
      
      // Switch to enhance tab if on restricted tabs
      const activeTab = document.querySelector('.tab-content.active');
      if (activeTab && (activeTab.id === 'menuTab' || activeTab.id === 'adminTab')) {
        switchTab('enhance');
      }
    }
  });

  // Allow uppercase input for redeem codes
  const redeemCodeInput = document.getElementById('redeemCodeInput');
  const adminCodeInput = document.getElementById('adminCodeInput');
  
  if (redeemCodeInput) {
    redeemCodeInput.addEventListener('input', function() {
      this.value = this.value.toUpperCase();
    });
  }
  
  if (adminCodeInput) {
    adminCodeInput.addEventListener('input', function() {
      this.value = this.value.toUpperCase();
    });
  }
});
    </script>
</body>
</html>
