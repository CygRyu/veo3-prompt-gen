<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veo 3 Prompt Generator</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo%20no%20bg.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo%20no%20bg.png">
    <link rel="shortcut icon" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo%20no%20bg.png">
    
    <!-- Apple Touch Icon for iOS -->
    <link rel="apple-touch-icon" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo.png">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlZlbyAzIFByb21wdCBHZW5lcmF0b3IiLAogICJzaG9ydF9uYW1lIjogIlZlbyAzIEdlbiIsCiAgImRlc2NyaXB0aW9uIjogIlByb21wdCBlbmhhbmNlciBmb3IgVmVvIDMiLAogICJzdGFydF91cmwiOiAiLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgInRoZW1lX2NvbG9yIjogIiM2MzY2RjEiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmZmZmZmYiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJodHRwczovL2dpdGh1Yi5jb20vQ3lnUnl1L3ZlbzMtcHJvbXB0LWdlbi9yYXcvbWFpbi9Mb2dvLnBuZyIsCiAgICAgICJzaXplcyI6ICIxOTJ4MTkyIiwKICAgICAgInR5cGUiOiAiaW1hZ2UvcG5nIgogICAgfSwKICAgIHsKICAgICAgInNyYyI6ICJodHRwczovL2dpdGh1Yi5jb20vQ3lnUnl1L3ZlbzMtcHJvbXB0LWdlbi9yYXcvbWFpbi9Mb2dvLnBuZyIsCiAgICAgICJzaXplcyI6ICI1MTJ4NTEyIiwKICAgICAgInR5cGUiOiAiaW1hZ2UvcG5nIgogICAgfQogIF0KfQ==">
    
    <!-- Meta Tags for Social Media Sharing -->
    <meta name="description" content="Create stunning AI video prompts for Veo 3 with our professional prompt generator. Enhance existing prompts or create new ones with advanced customization options.">
    <meta name="keywords" content="Veo 3, AI video, prompt generator, video generation, AI prompts">
    
    <!-- Open Graph Meta Tags (Facebook, LinkedIn, etc.) -->
    <meta property="og:title" content="Veo 3 Prompt Generator">
    <meta property="og:description" content="Create stunning AI video prompts for Veo 3 with our professional prompt generator.">
    <meta property="og:image" content="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo.png">
    <meta property="og:url" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Veo 3 Prompt Generator">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Veo 3 Prompt Generator">
    <meta name="twitter:description" content="Create stunning AI video prompts for Veo 3 with our professional prompt generator.">
    <meta name="twitter:image" content="https://github.com/CygRyu/veo3-prompt-gen/raw/main/Logo.png">
    
    <!-- Apple Web App Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Veo 3 Gen">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* Light theme colors */
            --primary-bg: #ffffff;
            --secondary-bg: #f8fafc;
            --tertiary-bg: #f1f5f9;
            --card-bg: #ffffff;
            --border-color: #e2e8f0;
            --border-hover: #cbd5e1;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-tertiary: #64748b;
            --text-muted: #94a3b8;
            
            /* Brand colors */
            --brand-primary: #6366f1;
            --brand-secondary: #8b5cf6;
            --brand-tertiary: #06b6d4;
            --brand-gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #06b6d4 100%);
            --brand-gradient-subtle: linear-gradient(135deg, #f0f0ff 0%, #f5f3ff 50%, #ecfeff 100%);
            
            /* Semantic colors */
            --success: #10b981;
            --success-bg: #ecfdf5;
            --warning: #f59e0b;
            --warning-bg: #fffbeb;
            --error: #ef4444;
            --error-bg: #fef2f2;
            --info: #3b82f6;
            --info-bg: #eff6ff;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            
            /* Spacing */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            --space-3xl: 4rem;
            
            /* Border radius */
            --radius-sm: 0.375rem;
            --radius: 0.5rem;
            --radius-md: 0.75rem;
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            
            /* Transitions */
            --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Dark theme */
        [data-theme="dark"] {
            --primary-bg: #0f172a;
            --secondary-bg: #1e293b;
            --tertiary-bg: #334155;
            --card-bg: #1e293b;
            --border-color: #334155;
            --border-hover: #475569;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --text-muted: #64748b;
            
            --brand-gradient-subtle: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #164e63 100%);
            
            --success-bg: #064e3b;
            --warning-bg: #451a03;
            --error-bg: #450a0a;
            --info-bg: #1e3a8a;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            background: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 16px;
            transition: var(--transition);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Header Styles */
        .header {
            background: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            padding: var(--space-md) var(--space-lg);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-sm);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            transition: var(--transition);
        }

        .logo:hover {
            color: var(--brand-primary);
            transform: translateY(-1px);
        }

        .logo-icon {
            font-size: 1.75rem;
            background: var(--brand-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-tabs {
            display: flex;
            gap: var(--space-xs);
            background: var(--secondary-bg);
            padding: var(--space-xs);
            border-radius: var(--radius-md);
        }

        .tab-button {
            background: transparent;
            border: none;
            padding: var(--space-sm) var(--space-md);
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: var(--radius);
            transition: var(--transition);
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .tab-button.active {
            background: var(--card-bg);
            color: var(--brand-primary);
            box-shadow: var(--shadow-sm);
        }

        .tab-button:hover:not(.active) {
            background: var(--tertiary-bg);
            color: var(--text-primary);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .theme-toggle {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: var(--space-sm);
            cursor: pointer;
            color: var(--text-secondary);
            transition: var(--transition);
            font-size: 1.125rem;
        }

        .theme-toggle:hover {
            background: var(--tertiary-bg);
            border-color: var(--border-hover);
            color: var(--text-primary);
        }

        .user-dropdown {
            position: relative;
        }

        .user-button {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--card-bg);
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .user-button:hover {
            background: var(--secondary-bg);
            border-color: var(--brand-primary);
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        .user-avatar {
            width: 2rem;
            height: 2rem;
            border-radius: var(--radius);
            background: var(--brand-gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .dropdown-menu {
            position: absolute;
            top: calc(100% + var(--space-sm));
            right: 0;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            min-width: 250px;
            z-index: 1000;
            display: none;
            overflow: hidden;
        }

        .dropdown-menu.show {
            display: block;
            animation: dropdownShow 0.2s ease-out;
        }

        @keyframes dropdownShow {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dropdown-header {
            padding: var(--space-md);
            border-bottom: 1px solid var(--border-color);
            background: var(--secondary-bg);
        }

        .dropdown-header .user-email {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-xs);
        }

        .dropdown-header .quota-display {
            font-size: 0.75rem;
            color: var(--brand-primary);
            font-weight: 600;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-md);
            text-decoration: none;
            color: var(--text-primary);
            font-size: 0.875rem;
            font-weight: 500;
            transition: var(--transition);
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
        }

        .dropdown-item:hover {
            background: var(--secondary-bg);
        }

        .dropdown-divider {
            height: 1px;
            background: var(--border-color);
            margin: var(--space-xs) 0;
        }

        .guest-auth {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .sign-in-btn {
            background: var(--brand-gradient);
            color: white;
            border: none;
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .sign-in-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        /* Mobile Header */
        .mobile-menu-btn {
            display: none;
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: var(--space-sm);
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 1.125rem;
            transition: var(--transition);
        }

        .mobile-menu-btn:hover {
            background: var(--tertiary-bg);
            color: var(--text-primary);
        }

        /* Main Content */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: var(--space-2xl) var(--space-lg);
        }

        /* Hero Section */
        .hero-section {
            text-align: center;
            margin-bottom: var(--space-3xl);
            padding: var(--space-2xl) 0;
            background: var(--brand-gradient-subtle);
            border-radius: var(--radius-xl);
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--brand-gradient);
            opacity: 0.03;
            pointer-events: none;
        }

        .hero-content {
            position: relative;
            z-index: 1;
        }

        .hero-title {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: var(--space-md);
            line-height: 1.2;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-lg);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: var(--space-xl);
            flex-wrap: wrap;
        }

        .hero-stat {
            text-align: center;
        }

        .hero-stat-value {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--brand-primary);
            display: block;
        }

        .hero-stat-label {
            font-size: 0.875rem;
            color: var(--text-tertiary);
            margin-top: var(--space-xs);
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: tabShow 0.3s ease-out;
        }

        @keyframes tabShow {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-bottom: var(--space-xl);
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }

        .card:hover {
            box-shadow: var(--shadow);
            border-color: var(--border-hover);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .card-title-icon {
            font-size: 1.25rem;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: var(--space-lg);
        }

        .form-grid {
            display: grid;
            gap: var(--space-lg);
        }

        .form-grid-2 {
            grid-template-columns: 1fr;
        }

        .form-grid-3 {
            grid-template-columns: 1fr;
        }

        label {
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
            display: block;
        }

        .input-group {
            position: relative;
        }

        input[type="text"],
        input[type="email"], 
        input[type="search"],
        input[type="number"],
        input[type="date"],
        select,
        textarea {
            width: 100%;
            padding: var(--space-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 1rem;
            font-family: inherit;
            background: var(--card-bg);
            color: var(--text-primary);
            transition: var(--transition);
            resize: vertical;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--brand-primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        textarea {
            min-height: 120px;
            font-family: 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .textarea-large {
            min-height: 200px;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-md) var(--space-lg);
            font-size: 0.875rem;
            font-weight: 600;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            font-family: inherit;
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--brand-gradient);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        .btn-secondary {
            background: var(--secondary-bg);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--tertiary-bg);
            border-color: var(--border-hover);
        }

        .btn-outline {
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .btn-outline:hover {
            background: var(--secondary-bg);
            color: var(--text-primary);
            border-color: var(--border-hover);
        }

        .btn-danger {
            background: var(--error);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .btn-lg {
            padding: var(--space-lg) var(--space-xl);
            font-size: 1rem;
        }

        .btn-sm {
            padding: var(--space-sm) var(--space-md);
            font-size: 0.75rem;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-md);
            margin: var(--space-2xl) 0;
            flex-wrap: wrap;
        }

        /* Output Section */
        .output-section {
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-top: var(--space-xl);
        }

        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            flex-wrap: wrap;
            gap: var(--space-md);
        }

        .output-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .output-content {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: var(--space-lg);
            font-family: 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            white-space: pre-wrap;
            color: var(--text-primary);
            min-height: 120px;
            position: relative;
        }

        .output-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-family: 'Inter', sans-serif;
        }

        /* Collapsible Sections */
        .collapsible {
            background: none;
            border: none;
            color: var(--brand-primary);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: var(--space-lg);
            padding: var(--space-md) 0;
            width: 100%;
            text-align: left;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .collapsible:hover {
            color: var(--brand-secondary);
        }

        .collapsible-icon {
            transition: var(--transition);
        }

        .collapsible.expanded .collapsible-icon {
            transform: rotate(90deg);
        }

        .advanced-section {
            display: none;
            margin-top: var(--space-lg);
        }

        .advanced-section.show {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Range Sliders */
        .slider-container {
            margin-bottom: var(--space-lg);
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-sm);
        }

        .slider-value {
            font-weight: 600;
            color: var(--brand-primary);
            font-size: 0.875rem;
            background: var(--brand-gradient-subtle);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius);
        }

        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--secondary-bg);
            outline: none;
            margin: var(--space-sm) 0;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--brand-gradient);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: var(--shadow);
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--brand-gradient);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: var(--shadow);
        }

        /* Toggle Switch */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin: var(--space-lg) 0;
        }

        .toggle-labels {
            display: flex;
            gap: var(--space-sm);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .toggle-label {
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius);
            transition: var(--transition);
        }

        .toggle-label.active {
            background: var(--brand-gradient);
            color: white;
        }

        .toggle-label.inactive {
            color: var(--text-tertiary);
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 52px;
            height: 28px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--border-color);
            border-radius: 28px;
            transition: var(--transition);
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background: white;
            border-radius: 50%;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        input:checked + .toggle-slider {
            background: var(--brand-primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }

        .stat-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            text-align: center;
            transition: var(--transition);
        }

        .stat-card:hover {
            box-shadow: var(--shadow);
            border-color: var(--border-hover);
            transform: translateY(-2px);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--brand-primary);
            margin-bottom: var(--space-xs);
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: var(--space-lg);
            right: var(--space-lg);
            padding: var(--space-md) var(--space-lg);
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            font-weight: 500;
            z-index: 1000;
            opacity: 0;
            transform: translateX(100px);
            transition: var(--transition-slow);
            box-shadow: var(--shadow-lg);
            min-width: 300px;
            border: 1px solid;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        .notification.success {
            background: var(--success-bg);
            color: var(--success);
            border-color: var(--success);
        }

        .notification.error {
            background: var(--error-bg);
            color: var(--error);
            border-color: var(--error);
        }

        .notification.warning {
            background: var(--warning-bg);
            color: var(--warning);
            border-color: var(--warning);
        }

        .notification.info {
            background: var(--info-bg);
            color: var(--info);
            border-color: var(--info);
        }

        /* Error Messages */
        .error-message {
            background: var(--error-bg);
            border: 1px solid var(--error);
            border-radius: var(--radius);
            padding: var(--space-md);
            margin: var(--space-md) 0;
            color: var(--error);
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        /* Gallery */
        .gallery-section {
            background: var(--secondary-bg);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin-top: var(--space-xl);
        }

        .video-container {
            position: relative;
            margin-bottom: var(--space-lg);
        }

        .video-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-md);
        }

        .video-frame {
            width: 100%;
            height: 315px;
            border: none;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .video-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: var(--space-lg);
        }

        .video-counter {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* Sign In Prompt */
        .sign-in-prompt {
            text-align: center;
            padding: var(--space-3xl) var(--space-lg);
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            color: var(--text-secondary);
        }

        .sign-in-prompt h3 {
            color: var(--text-primary);
            margin-bottom: var(--space-md);
            font-size: 1.5rem;
            font-weight: 600;
        }

        .sign-in-prompt p {
            margin-bottom: var(--space-lg);
            font-size: 1rem;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            margin-top: var(--space-lg);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--card-bg);
        }

        .data-table th,
        .data-table td {
            padding: var(--space-md);
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table th {
            background: var(--secondary-bg);
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--text-primary);
        }

        .data-table td {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .data-table tr:hover {
            background: var(--secondary-bg);
        }

        .table-actions {
            display: flex;
            gap: var(--space-md);
            align-items: center;
            margin-bottom: var(--space-lg);
            flex-wrap: wrap;
        }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: var(--space-3xl);
            padding: var(--space-2xl) 0 var(--space-xl);
            border-top: 1px solid var(--border-color);
            color: var(--text-tertiary);
            font-size: 0.875rem;
        }

        .footer-content {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-lg);
            flex-wrap: wrap;
        }

        .footer a {
            color: var(--brand-primary);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }

        .footer a:hover {
            color: var(--brand-secondary);
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .text-left {
            text-align: left;
        }

        .text-right {
            text-align: right;
        }

        .mb-0 { margin-bottom: 0 !important; }
        .mb-sm { margin-bottom: var(--space-sm); }
        .mb-md { margin-bottom: var(--space-md); }
        .mb-lg { margin-bottom: var(--space-lg); }
        .mb-xl { margin-bottom: var(--space-xl); }

        .mt-0 { margin-top: 0 !important; }
        .mt-sm { margin-top: var(--space-sm); }
        .mt-md { margin-top: var(--space-md); }
        .mt-lg { margin-top: var(--space-lg); }
        .mt-xl { margin-top: var(--space-xl); }

        /* Responsive Design */
        @media (min-width: 640px) {
            .form-grid-2 {
                grid-template-columns: 1fr 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 768px) {
            .main-content {
                padding: var(--space-2xl);
            }
            
            .form-grid-3 {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .video-frame {
                height: 400px;
            }
        }

        @media (max-width: 768px) {
            .nav-tabs {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                border-top: none;
                flex-direction: column;
                gap: 0;
                padding: var(--space-sm);
                box-shadow: var(--shadow-lg);
            }

            .nav-tabs.show {
                display: flex;
            }

            .mobile-menu-btn {
                display: block;
            }

            .header-content {
                position: relative;
            }

            .logo {
                font-size: 1.25rem;
            }

            .hero-section {
                margin-bottom: var(--space-xl);
                padding: var(--space-xl) var(--space-md);
            }

            .hero-stats {
                gap: var(--space-md);
            }

            .main-content {
                padding: var(--space-lg) var(--space-md);
            }

            .card {
                padding: var(--space-lg);
            }

            .action-buttons {
                flex-direction: column;
                gap: var(--space-sm);
            }

            .action-buttons .btn {
                width: 100%;
            }

            .output-header {
                flex-direction: column;
                align-items: stretch;
                gap: var(--space-sm);
            }

            .user-section {
                gap: var(--space-sm);
            }

            .theme-toggle {
                padding: var(--space-xs);
            }

            .notification {
                top: var(--space-sm);
                right: var(--space-sm);
                left: var(--space-sm);
                min-width: auto;
            }

            .video-frame {
                height: calc(100vw * 9 / 16 - var(--space-lg));
            }

            .table-actions {
                flex-direction: column;
                align-items: stretch;
            }

            .dropdown-menu {
                right: auto;
                left: 0;
                min-width: 100vw;
                max-width: 100vw;
                margin-left: calc(-1 * var(--space-lg));
            }
        }

        @media (max-width: 480px) {
            .hero-stats {
                flex-direction: column;
                gap: var(--space-md);
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading Animation */
        .loading-spinner {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            border-top-color: var(--brand-primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Help Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .modal-content {
            background: var(--card-bg);
            margin: 5% auto;
            padding: 0;
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--border-color);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-lg);
            border-bottom: 1px solid var(--border-color);
            background: var(--secondary-bg);
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: var(--space-xs);
            border-radius: var(--radius);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2rem;
            height: 2rem;
        }

        .modal-close:hover {
            color: var(--text-primary);
            background: var(--tertiary-bg);
        }

        .modal-body {
            padding: var(--space-lg);
            overflow-y: auto;
            max-height: calc(80vh - 80px);
        }

        .modal-body h4 {
            color: var(--brand-primary);
            margin-top: var(--space-lg);
            margin-bottom: var(--space-sm);
            font-size: 1rem;
            font-weight: 600;
        }

        .modal-body h4:first-child {
            margin-top: 0;
        }

        .modal-body ul {
            margin-left: var(--space-lg);
            margin-bottom: var(--space-md);
        }

        .modal-body li {
            margin-bottom: var(--space-xs);
            line-height: 1.6;
        }

        .modal-body .example {
            background: var(--secondary-bg);
            padding: var(--space-md);
            border-radius: var(--radius);
            border-left: 4px solid var(--brand-primary);
            margin: var(--space-md) 0;
            font-family: 'SF Mono', Consolas, monospace;
            font-size: 0.875rem;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">
                <span class="logo-icon">üé¨</span>
                <span>Veo 3 Generator</span>
            </a>
            
            <nav class="nav-tabs" id="navTabs">
                <button class="tab-button active" onclick="switchTab('enhance')">
                    <span>‚ú®</span> Enhance
                </button>
                <button class="tab-button" onclick="switchTab('remix')">
                    <span>üéõÔ∏è</span> Remix
                </button>
                <button class="tab-button" onclick="switchTab('menu')" id="menuTabBtn">
                    <span>üìã</span> Menu
                </button>
                <button class="tab-button hidden" onclick="switchTab('admin')" id="adminTabBtn">
                    <span>‚öôÔ∏è</span> Admin
                </button>
            </nav>

            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">‚ò∞</button>
            
            <div class="user-section">
                <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle" title="Toggle theme">
                    üåô
                </button>

                <!-- Guest State -->
                <div class="guest-auth" id="guestAuth">
                    <button class="sign-in-btn" id="signInBtn">
                        <span>üîê</span> Sign in with Google
                    </button>
                </div>

                <!-- User State -->
                <div class="user-dropdown hidden" id="userDropdown">
                    <button class="user-button" onclick="toggleUserDropdown()">
                        <div class="user-avatar" id="userAvatar">U</div>
                        <span id="userName">User</span>
                        <span style="font-size: 0.75rem;">‚ñº</span>
                    </button>
                    <div class="dropdown-menu" id="dropdownMenu">
                        <div class="dropdown-header">
                            <div class="user-email" id="userEmail">user@example.com</div>
                            <div class="quota-display" id="quotaDisplay">üéüÔ∏è 0 prompts left</div>
                        </div>
                        <button class="dropdown-item" onclick="switchTab('menu')">
                            <span>üìã</span> Menu & Redeem
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="signOutBtn">
                            <span>üö™</span> Sign Out
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Hero Section -->
        <section class="hero-section" id="heroSection">
            <div class="hero-content">
                <h1 class="hero-title">Create Amazing Video Prompts</h1>
                <p class="hero-subtitle">
                    Transform your ideas into professional Veo 3 prompts with our intelligent enhancement and remix tools
                </p>
                <div class="hero-stats">
                    <div class="hero-stat">
                        <span class="hero-stat-value" id="heroPromptsGenerated">0</span>
                        <span class="hero-stat-label">Prompts Generated</span>
                    </div>
                    <div class="hero-stat">
                        <span class="hero-stat-value" id="heroActiveUsers">0</span>
                        <span class="hero-stat-label">Active Users</span>
                    </div>
                    <div class="hero-stat">
                        <span class="hero-stat-value">40+</span>
                        <span class="hero-stat-label">Video Styles</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Enhance Tab Content -->
        <div id="enhanceTab" class="tab-content active">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span class="card-title-icon">‚ú®</span>
                        Enhance Your Prompt
                    </h2>
                    <button class="btn btn-outline btn-sm" onclick="showHelp('enhance')">
                        <span>‚ùì</span> Help
                    </button>
                </div>

                <!-- Basic Settings -->
                <div class="form-group">
                    <label for="description">Your Prompt *</label>
                    <div class="input-group">
                        <textarea id="description" class="textarea-large" placeholder="Describe your video idea... e.g., A cat flying through a futuristic city during a thunderstorm..."></textarea>
                    </div>
                </div>

                <div class="form-grid form-grid-2">
                    <div class="form-group">
                        <label for="subject">Subject / Character Focus</label>
                        <input id="subject" type="text" placeholder="e.g., Cat, Robot, Samurai, Cloud, etc."/>
                    </div>
                    
                    <div class="form-group">
                        <label for="action">Action / Movement Type</label>
                        <select id="action">
                            <option value="">Auto Detect</option>
                            <option>Walking</option>
                            <option>Dancing</option>
                            <option>Flying</option>
                            <option>Transformation</option>
                            <option>Interaction</option>
                            <option>Running</option>
                            <option>Jumping</option>
                            <option>Swimming</option>
                            <option>Climbing</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="style">Video Style</label>
                    <select id="style">
                        <option>Auto Detect (AI chooses best style)</option>
                        <option>Cinematic / Hollywood Film</option>
                        <option>Realistic Live Action</option>
                        <option>Aerial Cinematic Drone Shot</option>
                        <option>Time-lapse / Slow Motion</option>
                        <option>Film Noir / Black-and-White</option>
                        <option>Analog / Film Grain</option>
                        <option>IMAX Look</option>
                        <option>Documentary Style</option>
                        <option>Natural History / Wildlife</option>
                        <option>Found Footage / Handheld Cam</option>
                        <option>News Report Style</option>
                        <option>Surveillance Footage Look</option>
                        <option>Dreamscape / Surreal</option>
                        <option>Fantasy / Magic Realism</option>
                        <option>Oil Painting / Watercolor</option>
                        <option>Sketch / Ink Drawing</option>
                        <option>Abstract / Experimental</option>
                        <option>Double Exposure / Visual Metaphor</option>
                        <option>Stylized 2D Animation / Anime-like</option>
                        <option>Cartoon 2D</option>
                        <option>Cute Cartoon / Kawaii Style</option>
                        <option>Cartoon 3D / Pixar-like</option>
                        <option>Stop Motion Look</option>
                        <option>Claymation Style</option>
                        <option>Motion Graphic / Minimal Vector</option>
                        <option>Retro 80s / VHS Look</option>
                        <option>Cyberpunk / Futuristic</option>
                        <option>Noir Detective Style</option>
                        <option>Western / Cowboy Film</option>
                        <option>Horror (grainy, eerie lighting)</option>
                        <option>Tiny World / Tilt Shift</option>
                        <option>Microscopic View / Science-Lab Look</option>
                        <option>Macro Lens Simulation</option>
                        <option>Cinematic Portrait Mode</option>
                        <option>Bokeh-Focused Depth-of-Field</option>
                        <option>Overexposed / Underexposed Look</option>
                        <option>Infrared or Thermal Cam Simulation</option>
                        <option>Isometric / Diorama</option>
                        <option>Fantasy Landscapes</option>
                        <option>Post-Apocalyptic World</option>
                        <option>Urban Street Aesthetic</option>
                        <option>Studio Look (ASMR/Product Videos)</option>
                        <option>Video Game Gameplay</option>
                    </select>
                </div>

                <div class="form-grid form-grid-2">
                    <div class="form-group">
                        <label for="generalTone">General Tone</label>
                        <select id="generalTone" onchange="updateSubTones('enhance')">
                            <option value="">Auto Detect</option>
                            <option value="emotional">Emotional Tones</option>
                            <option value="suspense">Suspense & Thriller Tones</option>
                            <option value="action">Action & Adventure Tones</option>
                            <option value="artistic">Artistic & Creative Tones</option>
                            <option value="documentary">Documentary & Realistic Tones</option>
                            <option value="fantasy">Fantasy & Sci-Fi Tones</option>
                            <option value="social">Social & Cultural Tones</option>
                            <option value="unique">Unique/Niche Tones</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="subTone">Specific Tone</label>
                        <select id="subTone">
                            <option value="">Auto Detect</option>
                        </select>
                    </div>
                </div>

                <div class="form-grid form-grid-2">
                    <div class="form-group">
                        <label for="aspectRatio">Aspect Ratio</label>
                        <select id="aspectRatio">
                            <option value="16:9">16:9 (Widescreen)</option>
                            <option value="9:16">9:16 (Vertical)</option>
                            <option value="1:1">1:1 (Square)</option>
                            <option value="4:3">4:3 (Standard)</option>
                            <option value="21:9">21:9 (Ultra-wide)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="duration">Duration</label>
                        <input id="duration" type="text" value="8 seconds" readonly style="background-color: var(--tertiary-bg); color: var(--text-tertiary);"/>
                    </div>
                </div>

                <!-- Advanced Parameters -->
                <button class="collapsible" onclick="toggleAdvanced('enhance')">
                    <span class="collapsible-icon">‚ñ∂</span>
                    <span>Advanced Parameters (Optional)</span>
                </button>
                <div id="enhanceAdvanced" class="advanced-section">
                    <div class="card" style="margin-bottom: 0;">
                        <!-- Camera Settings -->
                        <h3 style="margin-bottom: var(--space-md); color: var(--text-primary);">üìπ Camera Settings</h3>
                        <div class="form-grid form-grid-3">
                            <div class="form-group">
                                <label for="cameraMovement">Camera Movement</label>
                                <select id="cameraMovement">
                                    <option>Auto Detect</option>
                                    <option>Static</option>
                                    <option>Pan Left/Right</option>
                                    <option>Zoom In/Out</option>
                                    <option>Dolly Forward/Back</option>
                                    <option>Steadycam</option>
                                    <option>Handheld</option>
                                    <option>Orbital</option>
                                    <option>Tracking Shot</option>
                                    <option>Crane</option>
                                    <option>Drone</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="cameraLevel">Camera Level</label>
                                <select id="cameraLevel">
                                    <option>Auto Detect</option>
                                    <option>Eye Level</option>
                                    <option>Low Angle</option>
                                    <option>High Angle</option>
                                    <option>Dutch Angle</option>
                                    <option>Overhead</option>
                                    <option>Point of View</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="lensType">Lens Type</label>
                                <select id="lensType">
                                    <option>Auto Detect</option>
                                    <option>Standard (50mm)</option>
                                    <option>Wide Angle (24mm)</option>
                                    <option>Telephoto (85mm+)</option>
                                    <option>Fisheye</option>
                                    <option>Anamorphic</option>
                                    <option>Macro</option>
                                </select>
                            </div>
                        </div>

                        <!-- Visual Settings -->
                        <h3 style="margin: var(--space-xl) 0 var(--space-md); color: var(--text-primary);">üé® Visual Settings</h3>
                        <div class="form-grid form-grid-2">
                            <div class="form-group">
                                <label for="depthOfField">Depth of Field</label>
                                <select id="depthOfField">
                                    <option>Auto Detect</option>
                                    <option>Shallow</option>
                                    <option>Medium</option>
                                    <option>Deep</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="lighting">Lighting Preference</label>
                                <select id="lighting">
                                    <option>Auto Detect</option>
                                    <option>Natural</option>
                                    <option>Dramatic</option>
                                    <option>Soft</option>
                                    <option>Harsh</option>
                                    <option>Golden Hour</option>
                                    <option>Blue Hour</option>
                                    <option>Neon</option>
                                    <option>Candlelit</option>
                                    <option>Studio Lighting</option>
                                </select>
                            </div>
                        </div>

                        <!-- Visual Effects Sliders -->
                        <h3 style="margin: var(--space-xl) 0 var(--space-md); color: var(--text-primary);">‚ú® Visual Effects</h3>
                        <div class="slider-container">
                            <div class="slider-header">
                                <label for="filmGrain">Film Grain</label>
                                <span class="slider-value" id="filmGrainValue">0%</span>
                            </div>
                            <input type="range" id="filmGrain" min="0" max="100" value="0" oninput="updateSliderValue('filmGrain')">
                        </div>

                        <div class="slider-container">
                            <div class="slider-header">
                                <label for="chromaticAberration">Chromatic Aberration</label>
                                <span class="slider-value" id="chromaticAberrationValue">0%</span>
                            </div>
                            <input type="range" id="chromaticAberration" min="0" max="100" value="0" oninput="updateSliderValue('chromaticAberration')">
                        </div>

                        <!-- Environment & Atmosphere -->
                        <h3 style="margin: var(--space-xl) 0 var(--space-md); color: var(--text-primary);">üåç Environment & Atmosphere</h3>
                        <div class="form-grid form-grid-3">
                            <div class="form-group">
                                <label for="environment">Environment/Setting</label>
                                <select id="environment">
                                    <option>Auto Detect</option>
                                    <option>Indoor</option>
                                    <option>Outdoor</option>
                                    <option>Urban</option>
                                    <option>Rural</option>
                                    <option>Fantasy World</option>
                                    <option>Space</option>
                                    <option>Underwater</option>
                                    <option>Desert</option>
                                    <option>Forest</option>
                                    <option>City</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="colorPalette">Color Palette</label>
                                <select id="colorPalette">
                                    <option>Auto Detect</option>
                                    <option>Warm Tones</option>
                                    <option>Cool Tones</option>
                                    <option>Monochrome</option>
                                    <option>Vibrant</option>
                                    <option>Muted</option>
                                    <option>Neon</option>
                                    <option>Pastel</option>
                                    <option>High Contrast</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="weather">Weather/Atmosphere</label>
                                <select id="weather">
                                    <option>Auto Detect</option>
                                    <option>Sunny</option>
                                    <option>Cloudy</option>
                                    <option>Rainy</option>
                                    <option>Foggy</option>
                                    <option>Stormy</option>
                                    <option>Snowy</option>
                                    <option>Windy</option>
                                    <option>Misty</option>
                                    <option>Clear</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="timeOfDay">Time of Day</label>
                                <select id="timeOfDay">
                                    <option>Auto Detect</option>
                                    <option>Dawn</option>
                                    <option>Morning</option>
                                    <option>Midday</option>
                                    <option>Afternoon</option>
                                    <option>Dusk</option>
                                    <option>Night</option>
                                    <option>Midnight</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="motionIntensity">Motion Intensity</label>
                                <select id="motionIntensity">
                                    <option>Auto Detect</option>
                                    <option>Subtle</option>
                                    <option>Moderate</option>
                                    <option>Dynamic</option>
                                    <option>Explosive</option>
                                    <option>Graceful</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="moodEmotion">Mood/Emotion</label>
                                <select id="moodEmotion">
                                    <option>Auto Detect</option>
                                    <option>Happy</option>
                                    <option>Mysterious</option>
                                    <option>Tense</option>
                                    <option>Peaceful</option>
                                    <option>Energetic</option>
                                    <option>Melancholic</option>
                                    <option>Triumphant</option>
                                    <option>Romantic</option>
                                </select>
                            </div>
                        </div>

                        <!-- Dialogue/Text Overlay -->
                        <div class="form-group">
                            <label for="dialogue">üí¨ Dialogue/Text Overlay (Optional)</label>
                            <textarea id="dialogue" rows="3" placeholder="Enter any dialogue or text elements to include..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="btn btn-danger" onclick="clearForm('enhance')">
                        <span>üóëÔ∏è</span> Clear All
                    </button>
                    <button class="btn btn-primary btn-lg" onclick="generatePrompt()">
                        <span>‚ú®</span> Enhance Prompt
                    </button>
                </div>

                <!-- Output Section -->
                <div id="enhanceOutputSection" class="output-section hidden">
                    <div class="output-header">
                        <h3 class="output-title">Enhanced Prompt</h3>
                        <button class="btn btn-secondary btn-sm" onclick="copyPrompt('enhanceOutput')">
                            <span>üìã</span> Copy Prompt
                        </button>
                    </div>
                    <div id="enhanceOutput" class="output-content"></div>
                </div>

                <!-- Sample Gallery -->
                <button class="collapsible" onclick="toggleGallery('enhance')">
                    <span class="collapsible-icon">‚ñ∂</span>
                    <span>Sample Gallery</span>
                </button>
                <div id="enhanceVideoGallery" class="gallery-section hidden">
                    <div class="video-container">
                        <div class="video-title" id="enhanceVideoTitle">Sample Video 1</div>
                        <iframe id="enhanceVideoFrame" class="video-frame" src="about:blank" allowfullscreen></iframe>
                    </div>
                    <div class="video-navigation">
                        <button class="btn btn-outline" id="enhancePrevBtn" onclick="previousVideo('enhance')">
                            <span>‚Üê</span> Previous
                        </button>
                        <span class="video-counter" id="enhanceVideoCounter">1 / 3</span>
                        <button class="btn btn-outline" id="enhanceNextBtn" onclick="nextVideo('enhance')">
                            Next <span>‚Üí</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Remix Tab Content -->
        <div id="remixTab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span class="card-title-icon">üéõÔ∏è</span>
                        Remix Existing Prompt
                    </h2>
                    <button class="btn btn-outline btn-sm" onclick="showHelp('remix')">
                        <span>‚ùì</span> Help
                    </button>
                </div>

                <!-- Remix Input Section -->
                <div class="form-group">
                    <label for="originalPrompt">Original Prompt *</label>
                    <textarea id="originalPrompt" class="textarea-large" placeholder="Paste your existing prompt here... (can be any length from simple to detailed)"></textarea>
                </div>

                <div class="form-group">
                    <label for="variationInstructions">How to Vary This Prompt *</label>
                    <textarea id="variationInstructions" rows="4" placeholder="e.g., Make the creature a giant lobster instead, and the view is from a drone, the time of day is dusk, the tone is chilling and gritty. And there is a deep old man voice narrating that says 'Earth is facing her end of time..'"></textarea>
                </div>

                <!-- Simple/Advanced Toggle -->
                <div class="toggle-container">
                    <div class="toggle-labels">
                        <span class="toggle-label active" id="simpleLabel">Simple</span>
                        <span class="toggle-label inactive" id="advancedLabel">Advanced</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="remixModeToggle" onchange="toggleRemixMode()">
                        <span class="toggle-slider"></span>
                    </label>
                </div>

                <!-- Advanced Remix Parameters (Hidden by default) -->
                <div id="remixAdvancedSection" class="hidden">
                    <div class="card" style="margin-bottom: 0;">
                        <!-- Copy all the same advanced fields from enhance tab with remix prefixes -->
                        <div class="form-grid form-grid-2">
                            <div class="form-group">
                                <label for="remixSubject">Subject / Character Focus</label>
                                <input id="remixSubject" type="text" placeholder="e.g., Cat, Robot, Samurai, Cloud, etc."/>
                            </div>
                            
                            <div class="form-group">
                                <label for="remixAction">Action / Movement Type</label>
                                <select id="remixAction">
                                    <option value="">Auto Detect</option>
                                    <option>Walking</option>
                                    <option>Dancing</option>
                                    <option>Flying</option>
                                    <option>Transformation</option>
                                    <option>Interaction</option>
                                    <option>Running</option>
                                    <option>Jumping</option>
                                    <option>Swimming</option>
                                    <option>Climbing</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="remixStyle">Video Style</label>
                            <select id="remixStyle">
                                <option>Auto Detect (AI chooses best style)</option>
                                <!-- Same options as enhance -->
                                <option>Cinematic / Hollywood Film</option>
                                <option>Realistic Live Action</option>
                                <option>Aerial Cinematic Drone Shot</option>
                                <option>Time-lapse / Slow Motion</option>
                                <option>Film Noir / Black-and-White</option>
                                <option>Analog / Film Grain</option>
                                <option>IMAX Look</option>
                                <option>Documentary Style</option>
                                <option>Natural History / Wildlife</option>
                                <option>Found Footage / Handheld Cam</option>
                                <option>News Report Style</option>
                                <option>Surveillance Footage Look</option>
                                <option>Dreamscape / Surreal</option>
                                <option>Fantasy / Magic Realism</option>
                                <option>Oil Painting / Watercolor</option>
                                <option>Sketch / Ink Drawing</option>
                                <option>Abstract / Experimental</option>
                                <option>Double Exposure / Visual Metaphor</option>
                                <option>Stylized 2D Animation / Anime-like</option>
                                <option>Cartoon 2D</option>
                                <option>Cute Cartoon / Kawaii Style</option>
                                <option>Cartoon 3D / Pixar-like</option>
                                <option>Stop Motion Look</option>
                                <option>Claymation Style</option>
                                <option>Motion Graphic / Minimal Vector</option>
                                <option>Retro 80s / VHS Look</option>
                                <option>Cyberpunk / Futuristic</option>
                                <option>Noir Detective Style</option>
                                <option>Western / Cowboy Film</option>
                                <option>Horror (grainy, eerie lighting)</option>
                                <option>Tiny World / Tilt Shift</option>
                                <option>Microscopic View / Science-Lab Look</option>
                                <option>Macro Lens Simulation</option>
                                <option>Cinematic Portrait Mode</option>
                                <option>Bokeh-Focused Depth-of-Field</option>
                                <option>Overexposed / Underexposed Look</option>
                                <option>Infrared or Thermal Cam Simulation</option>
                                <option>Isometric / Diorama</option>
                                <option>Fantasy Landscapes</option>
                                <option>Post-Apocalyptic World</option>
                                <option>Urban Street Aesthetic</option>
                                <option>Studio Look (ASMR/Product Videos)</option>
                                <option>Video Game Gameplay</option>
                            </select>
                        </div>

                        <!-- Continue with all other remix fields... -->
                        <!-- I'll abbreviate here for space, but include all the same fields with remix prefix -->
                        
                        <!-- Include all remaining advanced fields with remixPrefix -->
                        <div class="form-grid form-grid-2">
                            <div class="form-group">
                                <label for="remixGeneralTone">General Tone</label>
                                <select id="remixGeneralTone" onchange="updateSubTones('remix')">
                                    <option value="">Auto Detect</option>
                                    <option value="emotional">Emotional Tones</option>
                                    <option value="suspense">Suspense & Thriller Tones</option>
                                    <option value="action">Action & Adventure Tones</option>
                                    <option value="artistic">Artistic & Creative Tones</option>
                                    <option value="documentary">Documentary & Realistic Tones</option>
                                    <option value="fantasy">Fantasy & Sci-Fi Tones</option>
                                    <option value="social">Social & Cultural Tones</option>
                                    <option value="unique">Unique/Niche Tones</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="remixSubTone">Specific Tone</label>
                                <select id="remixSubTone">
                                    <option value="">Auto Detect</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="remixAspectRatio">Aspect Ratio</label>
                            <select id="remixAspectRatio">
                                <option value="16:9">16:9 (Widescreen)</option>
                                <option value="9:16">9:16 (Vertical)</option>
                                <option value="1:1">1:1 (Square)</option>
                                <option value="4:3">4:3 (Standard)</option>
                                <option value="21:9">21:9 (Ultra-wide)</option>
                            </select>
                        </div>

                        <!-- Add all other remix advanced fields here -->
                        <div class="form-group">
                            <label for="remixDialogue">üí¨ Dialogue/Text Overlay (Optional)</label>
                            <textarea id="remixDialogue" rows="3" placeholder="Enter any dialogue or text elements to include..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="btn btn-danger" onclick="clearForm('remix')">
                        <span>üóëÔ∏è</span> Clear All
                    </button>
                    <button class="btn btn-primary btn-lg" onclick="remixPrompt()">
                        <span>üéõÔ∏è</span> Remix Prompt
                    </button>
                </div>

                <!-- Output Section -->
                <div id="remixOutputSection" class="output-section hidden">
                    <div class="output-header">
                        <h3 class="output-title">Remixed Prompt</h3>
                        <button class="btn btn-secondary btn-sm" onclick="copyPrompt('remixOutput')">
                            <span>üìã</span> Copy Prompt
                        </button>
                    </div>
                    <div id="remixOutput" class="output-content"></div>
                </div>

                <!-- Sample Gallery -->
                <button class="collapsible" onclick="toggleGallery('remix')">
                    <span class="collapsible-icon">‚ñ∂</span>
                    <span>Sample Gallery</span>
                </button>
                <div id="remixVideoGallery" class="gallery-section hidden">
                    <div class="video-container">
                        <div class="video-title" id="remixVideoTitle">Sample Video 1</div>
                        <iframe id="remixVideoFrame" class="video-frame" src="about:blank" allowfullscreen></iframe>
                    </div>
                    <div class="video-navigation">
                        <button class="btn btn-outline" id="remixPrevBtn" onclick="previousVideo('remix')">
                            <span>‚Üê</span> Previous
                        </button>
                        <span class="video-counter" id="remixVideoCounter">1 / 3</span>
                        <button class="btn btn-outline" id="remixNextBtn" onclick="nextVideo('remix')">
                            Next <span>‚Üí</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Menu Tab Content -->
        <div id="menuTab" class="tab-content">
            <!-- Sign In Prompt (for guests) -->
            <div id="menuSignInPrompt" class="sign-in-prompt">
                <h3>Welcome to Veo 3 Generator! üëã</h3>
                <p>Sign in to access your personal dashboard, redeem codes, and track your prompt generation history.</p>
                <button class="btn btn-primary btn-lg" onclick="signIn()">
                    <span>üîê</span> Sign in with Google
                </button>
            </div>

            <!-- User Menu Content (for signed-in users) -->
            <div id="menuUserContent" class="hidden">
                <!-- Personal Statistics -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <span class="card-title-icon">üìä</span>
                            Your Statistics
                        </h2>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="userTotalGenerated">0</div>
                            <div class="stat-label">Total Prompts Generated</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="userEnhanceCount">0</div>
                            <div class="stat-label">Enhance Used</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="userRemixCount">0</div>
                            <div class="stat-label">Remix Used</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="userQuotaRemaining">0</div>
                            <div class="stat-label">Prompts Remaining</div>
                        </div>
                    </div>
                </div>

                <!-- Redeem Code Section -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <span class="card-title-icon">üéüÔ∏è</span>
                            Redeem Code
                        </h2>
                    </div>
                    <p style="margin-bottom: var(--space-lg); color: var(--text-secondary);">
                        Enter a redeem code to add more prompts to your account.
                    </p>
                    
                    <div class="form-grid form-grid-2">
                        <div class="form-group mb-0">
                            <label for="redeemCodeInput">Redeem Code</label>
                            <input type="text" id="redeemCodeInput" placeholder="Enter your code here" style="text-transform: uppercase;"/>
                        </div>
                        <div class="form-group mb-0" style="display: flex; align-items: end;">
                            <button class="btn btn-primary" onclick="redeemCode()" style="width: 100%;">
                                <span>üéÅ</span> Redeem Code
                            </button>
                        </div>
                    </div>
                    
                    <div id="redeemStatus" style="margin-top: var(--space-md);"></div>
                </div>

                <!-- Recent Activity -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <span class="card-title-icon">üìù</span>
                            Recent Activity
                        </h2>
                    </div>
                    <div id="recentActivity">
                        <p style="color: var(--text-tertiary); font-style: italic;">Loading recent activity...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Tab Content -->
        <div id="adminTab" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span class="card-title-icon">‚öôÔ∏è</span>
                        Admin Dashboard
                    </h2>
                </div>

                <!-- Dashboard Overview -->
                <div class="stats-grid mb-xl">
                    <div class="stat-card">
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-label">Total Users</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalPrompts">0</div>
                        <div class="stat-label">Total Prompts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="todayUsers">0</div>
                        <div class="stat-label">Active Today</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="todayPrompts">0</div>
                        <div class="stat-label">Prompts Today</div>
                    </div>
                </div>

                <!-- Code Management -->
                <div class="card">
                    <h3 style="margin-bottom: var(--space-lg); color: var(--text-primary);">üéüÔ∏è Create Redeem Code</h3>
                    <div class="form-grid form-grid-3">
                        <div class="form-group">
                            <label for="adminCodeInput">Code</label>
                            <input type="text" id="adminCodeInput" placeholder="e.g., WELCOME50" style="text-transform: uppercase;"/>
                        </div>
                        <div class="form-group">
                            <label for="adminQuotaInput">Quota</label>
                            <input type="number" id="adminQuotaInput" placeholder="50" min="1"/>
                        </div>
                        <div class="form-group">
                            <label for="adminExpiryInput">Expiry Date</label>
                            <input type="date" id="adminExpiryInput"/>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="createCode()">
                        <span>‚ú®</span> Create Code
                    </button>
                    <div id="adminCodeFeedback" style="margin-top: var(--space-md);"></div>
                </div>

                <!-- User Lookup -->
                <div class="card">
                    <h3 style="margin-bottom: var(--space-lg); color: var(--text-primary);">üîç User Lookup</h3>
                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label for="lookupEmailInput">User Email</label>
                            <input type="email" id="lookupEmailInput" placeholder="user@example.com"/>
                        </div>
                        <div class="form-group" style="display: flex; align-items: end;">
                            <button class="btn btn-primary" onclick="lookupUser()" style="width: 100%;">
                                <span>üîç</span> Find User
                            </button>
                        </div>
                    </div>
                    <div id="lookupResult" style="margin-top: var(--space-lg);"></div>
                </div>
            </div>
        </div>

        <!-- Help Modal -->
        <div id="helpModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="helpModalTitle">Help</h3>
                    <button class="modal-close" onclick="closeHelp()">&times;</button>
                </div>
                <div class="modal-body" id="helpModalContent">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <p><strong>Veo 3 Generator</strong> - Developed with ‚ù§Ô∏è by <strong>CygRyu</strong></p>
                <div>
                    <a href="https://ko-fi.com/cygryu" target="_blank">‚òï Ko-Fi</a>
                    <a href="https://www.paypal.com/paypalme/sofiansu?country.x=ID&locale.x=en_US" target="_blank">üí≥ PayPal</a>
                </div>
            </div>
        </footer>
    </main>

    <!-- Firebase Core SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

    <script>
        // Configuration - UPDATE THIS URL TO YOUR ACTUAL BACKEND URL
        const API_BASE_URL = "https://66f9e544-efaf-4086-a849-aefdefa94a7e-00-1ya2qyok05zo.sisko.replit.dev";

        // Theme management
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
                updateThemeToggle(savedTheme);
            } else if (prefersDark) {
                document.documentElement.setAttribute('data-theme', 'dark');
                updateThemeToggle('dark');
            } else {
                document.documentElement.setAttribute('data-theme', 'light');
                updateThemeToggle('light');
            }
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeToggle(newTheme);
        }

        function updateThemeToggle(theme) {
            const toggle = document.getElementById('themeToggle');
            toggle.textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            toggle.title = `Switch to ${theme === 'dark' ? 'light' : 'dark'} mode`;
        }

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (!localStorage.getItem('theme')) {
                const newTheme = event.matches ? 'dark' : 'light';
                document.documentElement.setAttribute('data-theme', newTheme);
                updateThemeToggle(newTheme);
            }
        });

        // Global state
        let currentUser = null;
        let userStats = {};
        let adminData = {};

        // Tone options mapping
        const toneOptions = {
            emotional: ['Happy/Joyful', 'Funny/Comedic', 'Heartwarming', 'Sad/Melancholic', 'Romantic', 'Inspirational/Motivational', 'Peaceful/Calming', 'Nostalgic'],
            suspense: ['Scary/Horror', 'Mysterious', 'Suspenseful', 'Dramatic', 'Dark', 'Thriller'],
            action: ['Epic/Heroic', 'Action-Packed', 'Adventurous', 'Energetic'],
            artistic: ['Dreamy/Surreal', 'Artistic/Aesthetic', 'Experimental', 'Minimalist'],
            documentary: ['Documentary', 'Realistic', 'Gritty', 'Professional'],
            fantasy: ['Magical', 'Futuristic', 'Fantasy'],
            social: ['Trendy/Hip', 'Retro/Vintage', 'Urban', 'Rural/Country'],
            unique: ['Quirky/Weird', 'Luxurious', 'Cozy', 'Badass', 'Awkward', 'Chaotic', 'Zen/Spiritual']
        };

        // Video gallery data
        const videoData = [
            {
                title: "Veo 3 Showcase Video - AI Video Generation Demo",
                url: "https://www.youtube.com/embed/MK2sbQper4M?rel=0"
            },
            {
                title: "Sample Video 2 - Advanced Settings Demo", 
                url: "https://www.youtube.com/embed/PLACEHOLDER_VIDEO_ID_2"
            },
            {
                title: "Sample Video 3 - Creative Style Examples",
                url: "https://www.youtube.com/embed/PLACEHOLDER_VIDEO_ID_3"
            }
        ];

        let currentVideoIndex = {
            enhance: 0,
            remix: 0
        };

        // Mobile menu toggle
        function toggleMobileMenu() {
            const navTabs = document.getElementById('navTabs');
            navTabs.classList.toggle('show');
        }

        // User dropdown toggle
        function toggleUserDropdown() {
            const dropdownMenu = document.getElementById('dropdownMenu');
            dropdownMenu.classList.toggle('show');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const userDropdown = document.querySelector('.user-dropdown');
            const dropdownMenu = document.getElementById('dropdownMenu');
            
            if (userDropdown && !userDropdown.contains(event.target)) {
                dropdownMenu.classList.remove('show');
            }
        });

        // Tab Management
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // Add active class to selected tab button
            document.querySelector(`.tab-button[onclick="switchTab('${tabName}')"]`).classList.add('active');

            // Close mobile menu
            document.getElementById('navTabs').classList.remove('show');

            // Hide hero section on non-enhance tabs
            const heroSection = document.getElementById('heroSection');
            if (tabName === 'enhance') {
                heroSection.style.display = 'block';
            } else {
                heroSection.style.display = 'none';
            }

            // Load tab-specific data
            if (tabName === 'menu' && currentUser) {
                loadUserStats();
            } else if (tabName === 'admin' && isAdmin(currentUser?.uid)) {
                loadAdminData();
            }
        }

        // Remix Mode Toggle
        function toggleRemixMode() {
            const toggle = document.getElementById('remixModeToggle');
            const simpleLabel = document.getElementById('simpleLabel');
            const advancedLabel = document.getElementById('advancedLabel');
            const advancedSection = document.getElementById('remixAdvancedSection');
            
            if (toggle.checked) {
                // Advanced mode
                simpleLabel.classList.remove('active');
                simpleLabel.classList.add('inactive');
                advancedLabel.classList.remove('inactive');
                advancedLabel.classList.add('active');
                advancedSection.classList.remove('hidden');
            } else {
                // Simple mode
                advancedLabel.classList.remove('active');
                advancedLabel.classList.add('inactive');
                simpleLabel.classList.remove('inactive');
                simpleLabel.classList.add('active');
                advancedSection.classList.add('hidden');
            }
        }

        function toggleAdvanced(tabName) {
            const adv = document.getElementById(tabName + "Advanced");
            const button = event.target.closest('.collapsible');
            const icon = button.querySelector('.collapsible-icon');
            
            if (adv.classList.contains('show')) {
                adv.classList.remove('show');
                button.classList.remove('expanded');
                button.innerHTML = '<span class="collapsible-icon">‚ñ∂</span><span>Advanced Parameters (Optional)</span>';
            } else {
                adv.classList.add('show');
                button.classList.add('expanded');
                button.innerHTML = '<span class="collapsible-icon">‚ñº</span><span>Advanced Parameters (Optional)</span>';
            }
        }

        function toggleGallery(tabName) {
            const gallery = document.getElementById(tabName + "VideoGallery");
            const button = event.target.closest('.collapsible');
            
            if (gallery.classList.contains('hidden')) {
                gallery.classList.remove('hidden');
                button.classList.add('expanded');
                button.innerHTML = '<span class="collapsible-icon">‚ñº</span><span>Sample Gallery</span>';
                loadVideo(tabName, currentVideoIndex[tabName]);
            } else {
                gallery.classList.add('hidden');
                button.classList.remove('expanded');
                button.innerHTML = '<span class="collapsible-icon">‚ñ∂</span><span>Sample Gallery</span>';
            }
        }

        function loadVideo(tabName, index) {
            if (index >= 0 && index < videoData.length) {
                const video = videoData[index];
                document.getElementById(tabName + "VideoFrame").src = video.url;
                document.getElementById(tabName + "VideoTitle").textContent = video.title;
                document.getElementById(tabName + "VideoCounter").textContent = `${index + 1} / ${videoData.length}`;
                
                // Update navigation buttons
                document.getElementById(tabName + "PrevBtn").disabled = index === 0;
                document.getElementById(tabName + "NextBtn").disabled = index === videoData.length - 1;
                
                currentVideoIndex[tabName] = index;
            }
        }

        function previousVideo(tabName) {
            if (currentVideoIndex[tabName] > 0) {
                loadVideo(tabName, currentVideoIndex[tabName] - 1);
            }
        }

        function nextVideo(tabName) {
            if (currentVideoIndex[tabName] < videoData.length - 1) {
                loadVideo(tabName, currentVideoIndex[tabName] + 1);
            }
        }

        function updateSubTones(tabName) {
            const prefix = tabName === 'enhance' ? '' : 'remix';
            const generalToneId = prefix ? prefix + 'GeneralTone' : 'generalTone';
            const subToneId = prefix ? prefix + 'SubTone' : 'subTone';
            
            const generalTone = document.getElementById(generalToneId).value;
            const subToneSelect = document.getElementById(subToneId);
            
            // Clear existing options
            subToneSelect.innerHTML = '<option value="">Auto Detect</option>';
            
            if (generalTone && toneOptions[generalTone]) {
                toneOptions[generalTone].forEach(tone => {
                    const option = document.createElement('option');
                    option.value = tone;
                    option.textContent = tone;
                    subToneSelect.appendChild(option);
                });
            }
        }

        function updateSliderValue(sliderId) {
            const slider = document.getElementById(sliderId);
            const valueSpan = document.getElementById(sliderId + 'Value');
            valueSpan.textContent = slider.value + '%';
        }

        function showError(message) {
            // Remove existing error messages
            const existingErrors = document.querySelectorAll('.error-message');
            existingErrors.forEach(error => error.remove());
            
            // Create new error message
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.innerHTML = `<span>‚ö†Ô∏è</span><span>${message}</span>`;
            
            // Insert in current active tab
            const activeTab = document.querySelector('.tab-content.active');
            const firstCard = activeTab.querySelector('.card');
            firstCard.insertBefore(errorDiv, firstCard.firstChild);
            
            // Scroll to error
            errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Clear form function
        function clearForm(tabName) {
            if (confirm('Are you sure you want to clear all fields? This action cannot be undone.')) {
                if (tabName === 'enhance') {
                    // Clear enhance form
                    document.getElementById('description').value = '';
                    document.getElementById('subject').value = '';
                    document.getElementById('action').selectedIndex = 0;
                    document.getElementById('style').selectedIndex = 0;
                    document.getElementById('generalTone').selectedIndex = 0;
                    document.getElementById('subTone').selectedIndex = 0;
                    document.getElementById('aspectRatio').selectedIndex = 0;
                    document.getElementById('cameraMovement').selectedIndex = 0;
                    document.getElementById('cameraLevel').selectedIndex = 0;
                    document.getElementById('lensType').selectedIndex = 0;
                    document.getElementById('depthOfField').selectedIndex = 0;
                    document.getElementById('lighting').selectedIndex = 0;
                    document.getElementById('filmGrain').value = 0;
                    updateSliderValue('filmGrain');
                    document.getElementById('chromaticAberration').value = 0;
                    updateSliderValue('chromaticAberration');
                    document.getElementById('environment').selectedIndex = 0;
                    document.getElementById('colorPalette').selectedIndex = 0;
                    document.getElementById('weather').selectedIndex = 0;
                    document.getElementById('timeOfDay').selectedIndex = 0;
                    document.getElementById('motionIntensity').selectedIndex = 0;
                    document.getElementById('moodEmotion').selectedIndex = 0;
                    document.getElementById('dialogue').value = '';
                    
                    // Hide output section
                    document.getElementById('enhanceOutputSection').classList.add('hidden');
                } else {
                    // Clear remix form
                    document.getElementById('originalPrompt').value = '';
                    document.getElementById('variationInstructions').value = '';
                    
                    // Reset toggle to simple mode
                    document.getElementById('remixModeToggle').checked = false;
                    toggleRemixMode();
                    
                    // Clear advanced fields if they exist
                    const advancedFields = ['remixSubject', 'remixAction', 'remixStyle', 'remixGeneralTone', 'remixSubTone', 'remixAspectRatio', 'remixDialogue'];
                    advancedFields.forEach(fieldId => {
                        const field = document.getElementById(fieldId);
                        if (field) {
                            if (field.tagName === 'SELECT') {
                                field.selectedIndex = 0;
                            } else {
                                field.value = '';
                            }
                        }
                    });
                    
                    // Hide output section
                    document.getElementById('remixOutputSection').classList.add('hidden');
                }
                
                // Remove any existing error messages
                const existingErrors = document.querySelectorAll('.error-message');
                existingErrors.forEach(error => error.remove());
            }
        }

        // Help modal functions
        function showHelp(tabName) {
            const modal = document.getElementById('helpModal');
            const title = document.getElementById('helpModalTitle');
            const content = document.getElementById('helpModalContent');
            
            if (tabName === 'enhance') {
                title.textContent = 'Enhance Tab - Best Practices';
                content.innerHTML = `
                    <h4>üéØ What is the Enhance Feature?</h4>
                    <p>The Enhance feature transforms your basic prompt idea into a detailed, professional-quality Veo 3 prompt with rich cinematographic details, structured formatting, and technical specifications optimized for AI video generation.</p>
                    
                    <h4>üìù How to Use Effectively:</h4>
                    <ul>
                        <li><strong>Start Simple:</strong> Enter a basic description in "Your Prompt" field (e.g., "A cat flying through a city")</li>
                        <li><strong>Add Context:</strong> Use Subject and Action fields to specify key elements and movements</li>
                        <li><strong>Choose Style:</strong> Select from 40+ video styles including Cinematic, Documentary, Animation, VHS, etc.</li>
                        <li><strong>Set Tone:</strong> Pick from 8 general tone categories with specific sub-tones for precise mood control</li>
                        <li><strong>Advanced Parameters:</strong> Fine-tune camera movement, lighting, visual effects, environment, and atmosphere</li>
                        <li><strong>Include Dialogue:</strong> Add specific dialogue in quotes - the AI will preserve exact wording and add proper formatting</li>
                    </ul>
                    
                    <h4>üí° Pro Tips:</h4>
                    <ul>
                        <li><strong>Start Broad:</strong> Even vague prompts work well - the AI will add professional details</li>
                        <li><strong>Control Tips:</strong> But if you want more control in output result, feel free to be as detailed as possible</li>
                        <li><strong>Mix Styles:</strong> Combine different elements for unique results (e.g., "Horror + Documentary")</li>
                        <li><strong>Use Auto Detect:</strong> Let AI choose optimal settings when unsure</li>
                        <li><strong>Dialogue Precision:</strong> The AI preserves exact dialogue wording and adds proper tone descriptions</li>
                        <li><strong>Technical Quality:</strong> Generated prompts include professional terminology for lighting, camera work, and audio design</li>
                    </ul>
                    
                    <div class="example">
                        <strong>Example Enhancement:</strong><br>
                        <strong>Input:</strong> "A robot serving coffee"<br>
                        <strong>Enhanced Output:</strong><br>
                        "Medium shot. Subject: A sleek, humanoid robot with polished chrome exterior and gentle blue LED eyes, wearing a vintage coffee shop apron, carefully operating a professional espresso machine. Scene: Modern caf√© interior with warm wood furnishings, exposed brick walls, and soft natural light filtering through large windows. Action: The robot methodically steams milk with precise movements, creating perfect microfoam while maintaining eye contact with an off-camera customer. Style: Cinematic, high-definition with warm color grading and shallow depth of field. Audio: Gentle hiss of the espresso machine, subtle caf√© ambiance, and the robot's soft mechanical whirring. --ar 16:9"
                    </div>
                `;
            } else {
                title.textContent = 'Remix Tab - Best Practices';
                content.innerHTML = `
                    <h4>üéõÔ∏è What is the Remix Feature?</h4>
                    <p>The Remix feature takes any existing prompt (from social media, other generators, or previous creations) and creates intelligent variations based on your specific instructions. Perfect for adapting viral prompts, exploring creative alternatives, or fine-tuning existing concepts. (PS: It also enhances the output prompt automatically. How cool is that?)</p>
                    
                    <h4>üìù How to Use Effectively:</h4>
                    <ul>
                        <li><strong>Paste Original:</strong> Copy any existing prompt into "Original Prompt" field</li>
                        <li><strong>Specify Changes:</strong> Clearly describe modifications in "How to Vary This Prompt" field</li>
                        <li><strong>Choose Mode:</strong> Toggle between Simple and Advanced remix modes</li>
                        <li><strong>Be Specific:</strong> The more detailed your variation instructions, the more precise the output</li>
                    </ul>
                    
                    <h4>üîÄ Simple vs Advanced Mode:</h4>
                    <ul>
                        <li><strong>Simple Mode:</strong> 
                            <ul>
                                <li>Uses only your variation instructions and the original prompt</li>
                                <li>Maintains original structure and style elements where possible</li>
                                <li>Best for quick character swaps, setting changes, or mood shifts</li>
                            </ul>
                        </li>
                        <li><strong>Advanced Mode:</strong>
                            <ul>
                                <li>Combines variation instructions with all technical parameters</li>
                                <li>Complete reconstruction using both original concept and new specifications</li>
                                <li>Best for comprehensive reimagining with technical precision</li>
                            </ul>
                        </li>
                    </ul>
                    
                    <h4>üí° Pro Remix Tips:</h4>
                    <ul>
                        <li><strong>Viral Adaptation:</strong> Take trending prompts and add your unique twist</li>
                        <li><strong>Incremental Changes:</strong> Change one element at a time for controlled experimentation</li>
                        <li><strong>Genre Hopping:</strong> Transform realistic prompts to fantasy, horror to comedy, etc.</li>
                        <li><strong>Technical Enhancement:</strong> Use Advanced mode to add professional cinematography to simple prompts</li>
                        <li><strong>Dialogue Integration:</strong> Add character voices and specific lines to existing visual prompts</li>
                        <li><strong>Creative Conflicts:</strong> Intentionally mix contradictory elements for surprising artistic results</li>
                    </ul>
                    
                    <div class="example">
                        <strong>Advanced Mode Example:</strong><br>
                        <strong>Original:</strong> "A towering creature resembling a pine tree with multiple glowing eyes stands still in the dense forest fog..."<br>
                        <strong>Variation:</strong> "Change the creature to a towering spider with multiple eyes and sharp mandibles. Continuously sprouting web that traps nearby running people. People are screaming."<br>
                        <strong>Advanced Parameters:</strong> "Video Style: Analog/Film Grain, Time of Day: Dusk"<br>
                        <strong>Result:</strong> "The camera adopts a handheld perspective, weaving through densely packed trees in a fog-laden forest at dusk, capturing the unsettling sight of a towering spider-like creature..."
                    </div>
                `;
            }
            
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeHelp() {
            document.getElementById('helpModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('helpModal');
            if (event.target === modal) {
                closeHelp();
            }
        }

        // Authentication functions
        function signIn() {
            const signInBtn = document.getElementById('signInBtn');
            signInBtn.click();
        }

        // Generate and remix functions
        async function generatePrompt() {
            console.log("Generate function called");
            
            // Validate description field
            const description = document.getElementById("description").value.trim();
            if (!description) {
                showError("Please enter a prompt description before generating.");
                return;
            }
            
            // Check if user is logged in
            if (!window.currentUID) {
                showError("Please sign in to use this feature.");
                return;
            }
            
            // Remove any existing error messages
            const existingErrors = document.querySelectorAll('.error-message');
            existingErrors.forEach(error => error.remove());

            const user = firebase.auth().currentUser;
            const userEmail = user ? user.email : "";

            const payload = {
                uid: window.currentUID,
                email: userEmail,
                description: description,
                subject: document.getElementById("subject").value,
                action: document.getElementById("action").value,
                style: document.getElementById("style").value,
                generalTone: document.getElementById("generalTone").value,
                subTone: document.getElementById("subTone").value,
                aspectRatio: document.getElementById("aspectRatio").value,
                cameraMovement: document.getElementById("cameraMovement").value,
                cameraLevel: document.getElementById("cameraLevel").value,
                lensType: document.getElementById("lensType").value,
                depthOfField: document.getElementById("depthOfField").value,
                lighting: document.getElementById("lighting").value,
                filmGrain: document.getElementById("filmGrain").value,
                chromaticAberration: document.getElementById("chromaticAberration").value,
                environment: document.getElementById("environment").value,
                colorPalette: document.getElementById("colorPalette").value,
                weather: document.getElementById("weather").value,
                timeOfDay: document.getElementById("timeOfDay").value,
                motionIntensity: document.getElementById("motionIntensity").value,
                moodEmotion: document.getElementById("moodEmotion").value,
                dialogue: document.getElementById("dialogue").value
            };

            console.log("Sending payload:", payload);

            const outputContent = document.getElementById("enhanceOutput");
            outputContent.innerHTML = '<div class="output-loading"><span class="loading-spinner"></span> Generating your enhanced prompt...</div>';
            document.getElementById("enhanceOutputSection").classList.remove("hidden");

            try {
                const response = await fetch(`${API_BASE_URL}/generate`, {
                    method: "POST",
                    headers: { 
                        "Content-Type": "application/json",
                        "Accept": "application/json"
                    },
                    body: JSON.stringify(payload)
                });

                console.log("Response status:", response.status);
                
                const data = await response.json();
                console.log("Response data:", data);
                
                if (response.ok && data.prompt) {
                    outputContent.textContent = data.prompt;
                    await updateQuotaCounter();
                    if (currentUser) {
                        loadUserStats(); // Refresh stats
                    }
                } else {
                    showError(data.error || "Server error occurred.");
                    document.getElementById("enhanceOutputSection").classList.add("hidden");
                }
            } catch (error) {
                console.error('Network error:', error);
                showError("Error connecting to server. Please check your internet connection and try again.");
                document.getElementById("enhanceOutputSection").classList.add("hidden");
            }
        }

        async function remixPrompt() {
            console.log("Remix function called");
            
            // Validate required fields
            const originalPrompt = document.getElementById("originalPrompt").value.trim();
            const variationInstructions = document.getElementById("variationInstructions").value.trim();
            
            if (!originalPrompt) {
                showError("Please enter an original prompt to remix.");
                return;
            }
            
            if (!variationInstructions) {
                showError("Please specify how you want to vary the prompt.");
                return;
            }
            
            // Check if user is logged in
            if (!window.currentUID) {
                showError("Please sign in to use this feature.");
                return;
            }
            
            // Remove any existing error messages
            const existingErrors = document.querySelectorAll('.error-message');
            existingErrors.forEach(error => error.remove());

            const user = firebase.auth().currentUser;
            const userEmail = user ? user.email : "";

            const isAdvancedMode = document.getElementById('remixModeToggle').checked;
            
            const payload = {
                uid: window.currentUID,
                email: userEmail,
                originalPrompt: originalPrompt,
                variationInstructions: variationInstructions,
                remixMode: isAdvancedMode ? "advanced" : "simple"
            };

            // Add advanced parameters if in advanced mode
            if (isAdvancedMode) {
                payload.subject = document.getElementById("remixSubject")?.value || "";
                payload.action = document.getElementById("remixAction")?.value || "";
                payload.style = document.getElementById("remixStyle")?.value || "";
                payload.generalTone = document.getElementById("remixGeneralTone")?.value || "";
                payload.subTone = document.getElementById("remixSubTone")?.value || "";
                payload.aspectRatio = document.getElementById("remixAspectRatio")?.value || "";
                payload.dialogue = document.getElementById("remixDialogue")?.value || "";
                // Add other remix advanced fields as needed
            }

            console.log("Sending remix payload:", payload);

            const outputContent = document.getElementById("remixOutput");
            outputContent.innerHTML = '<div class="output-loading"><span class="loading-spinner"></span> Remixing your prompt...</div>';
            document.getElementById("remixOutputSection").classList.remove("hidden");

            try {
                const response = await fetch(`${API_BASE_URL}/remix`, {
                    method: "POST",
                    headers: { 
                        "Content-Type": "application/json",
                        "Accept": "application/json"
                    },
                    body: JSON.stringify(payload)
                });

                console.log("Remix response status:", response.status);

                const data = await response.json();
                console.log("Remix response data:", data);
                
                if (response.ok && data.prompt) {
                    outputContent.textContent = data.prompt;
                    await updateQuotaCounter();
                    if (currentUser) {
                        loadUserStats(); // Refresh stats
                    }
                } else {
                    showError(data.error || "Server error occurred.");
                    document.getElementById("remixOutputSection").classList.add("hidden");
                }
            } catch (error) {
                console.error('Network error:', error);
                showError("Error connecting to server. Please check your internet connection and try again.");
                document.getElementById("remixOutputSection").classList.add("hidden");
            }
        }

        function copyPrompt(outputId) {
            const output = document.getElementById(outputId);
            const text = output.textContent;
            
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(text).then(() => {
                    showCopyFeedback();
                }).catch(err => {
                    console.error('Failed to copy:', err);
                    fallbackCopyTextToClipboard(text);
                });
            } else {
                fallbackCopyTextToClipboard(text);
            }
        }

        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-999999px";
            textArea.style.top = "-999999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showCopyFeedback();
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
            }
            
            document.body.removeChild(textArea);
        }

        function showCopyFeedback() {
            // Show popup notification
            showNotification('‚úÖ Copied to clipboard!', 'success');
            
            // Also change button text briefly
            const button = event.target.closest('.btn');
            if (button) {
                const originalText = button.innerHTML;
                button.innerHTML = '<span>‚úÖ</span> Copied!';
                button.style.background = 'var(--success)';
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.style.background = '';
                }, 2000);
            }
        }

        function showNotification(message, type = 'success') {
            // Remove any existing notification
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            // Create new notification
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            // Add to body
            document.body.appendChild(notification);
            
            // Trigger animation
            requestAnimationFrame(() => {
                notification.classList.add('show');
            });
            
            // Remove after delay
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, 3500);
        }

        async function updateQuotaCounter() {
            if (!window.currentUID) return;

            try {
                const response = await fetch(`${API_BASE_URL}/get-quota`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: window.currentUID })
                });

                const data = await response.json();
                if (data.quota !== undefined) {
                    const quotaDisplay = document.getElementById("quotaDisplay");
                    if (quotaDisplay) {
                        quotaDisplay.textContent = `üéüÔ∏è ${data.quota} prompts left`;
                    }
                    
                    // Update menu stats if visible
                    const userQuotaRemaining = document.getElementById("userQuotaRemaining");
                    if (userQuotaRemaining) {
                        userQuotaRemaining.textContent = data.quota;
                    }
                }
            } catch (e) {
                console.error("Quota fetch failed:", e);
            }
        }

        // Menu tab functions
        async function loadUserStats() {
            if (!window.currentUID) return;

            try {
                const response = await fetch(`${API_BASE_URL}/user-stats`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: window.currentUID })
                });

                const data = await response.json();
                if (response.ok) {
                    userStats = data;
                    
                    // Update stats display
                    document.getElementById("userTotalGenerated").textContent = data.totalGenerated || 0;
                    document.getElementById("userEnhanceCount").textContent = data.enhanceCount || 0;
                    document.getElementById("userRemixCount").textContent = data.remixCount || 0;
                    document.getElementById("userQuotaRemaining").textContent = data.quota || 0;
                    
                    // Update recent activity
                    const recentActivity = document.getElementById("recentActivity");
                    if (data.recentActivity && data.recentActivity.length > 0) {
                        recentActivity.innerHTML = data.recentActivity.map(activity => `
                            <div style="padding: var(--space-md); border-bottom: 1px solid var(--border-color); border-radius: var(--radius); background: var(--secondary-bg); margin-bottom: var(--space-sm);">
                                <div style="font-weight: 600; color: var(--text-primary);">${activity.type}</div>
                                <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: var(--space-xs);">${activity.date}</div>
                            </div>
                        `).join('');
                    } else {
                        recentActivity.innerHTML = '<div style="text-align: center; padding: var(--space-xl); color: var(--text-tertiary); font-style: italic;">No recent activity</div>';
                    }
                }
            } catch (error) {
                console.error("Failed to load user stats:", error);
            }
        }

        // Redeem code function
        async function redeemCode() {
            const code = document.getElementById('redeemCodeInput').value.trim();
            const uid = window.currentUID;
            const user = firebase.auth().currentUser;

            if (!uid || !code || !user || !user.email) {
                showNotification("‚ùå Please enter a code and sign in.", 'error');
                return;
            }

            const redeemStatus = document.getElementById('redeemStatus');
            redeemStatus.innerHTML = '<div style="color: var(--text-secondary); display: flex; align-items: center; gap: var(--space-sm);"><span class="loading-spinner"></span> Redeeming code...</div>';

            try {
                const response = await fetch(`${API_BASE_URL}/redeem-code`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid, code, email: user.email })
                });

                const data = await response.json();
                if (data.success) {
                    showNotification(`‚úÖ Code redeemed! +${data.added} prompts added.`, 'success');
                    document.getElementById('redeemCodeInput').value = '';
                    redeemStatus.innerHTML = `<div style="color: var(--success); font-weight: 500;">‚úÖ Successfully redeemed! +${data.added} prompts added.</div>`;
                    await updateQuotaCounter();
                    loadUserStats(); // Refresh stats
                } else {
                    showNotification(`‚ùå ${data.error}`, 'error');
                    redeemStatus.innerHTML = `<div style="color: var(--error); font-weight: 500;">‚ùå ${data.error}</div>`;
                }
            } catch (err) {
                console.error("Redeem failed", err);
                showNotification("‚ö†Ô∏è Network error", 'warning');
                redeemStatus.innerHTML = '<div style="color: var(--warning); font-weight: 500;">‚ö†Ô∏è Network error. Please try again.</div>';
            }
        }

        // Admin functions
        function isAdmin(uid) {
            const ADMIN_UIDS = ["9n0qDAZ5xYOYmoBpcpbdvgv13I42"];
            return ADMIN_UIDS.includes(uid);
        }

        async function loadAdminData() {
            if (!window.currentUID || !isAdmin(window.currentUID)) return;

            try {
                const response = await fetch(`${API_BASE_URL}/admin-stats`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: window.currentUID })
                });

                const data = await response.json();
                if (response.ok) {
                    adminData = data;
                    
                    // Update admin stats display
                    document.getElementById("totalUsers").textContent = data.totalUsers || 0;
                    document.getElementById("totalPrompts").textContent = data.totalPrompts || 0;
                    document.getElementById("todayUsers").textContent = data.todayUsers || 0;
                    document.getElementById("todayPrompts").textContent = data.todayPrompts || 0;
                }
            } catch (error) {
                console.error("Failed to load admin data:", error);
            }
        }

        async function createCode() {
            const code = document.getElementById('adminCodeInput').value.trim().toUpperCase();
            const quota = parseInt(document.getElementById('adminQuotaInput').value.trim());
            const expires = document.getElementById('adminExpiryInput').value;

            if (!code || !quota || !expires) {
                showNotification("‚ùå All fields are required.", 'error');
                return;
            }

            const feedback = document.getElementById('adminCodeFeedback');
            feedback.innerHTML = '<div style="color: var(--text-secondary); display: flex; align-items: center; gap: var(--space-sm);"><span class="loading-spinner"></span> Creating code...</div>';

            try {
                const response = await fetch(`${API_BASE_URL}/create-code`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ code, quota, expires, uid: window.currentUID })
                });

                const data = await response.json();
                if (data.success) {
                    showNotification("‚úÖ Code created successfully!", 'success');
                    feedback.innerHTML = `<div style="color: var(--success); font-weight: 500;">‚úÖ Code "${code}" created successfully!</div>`;
                    
                    // Clear form
                    document.getElementById('adminCodeInput').value = '';
                    document.getElementById('adminQuotaInput').value = '';
                    document.getElementById('adminExpiryInput').value = '';
                } else {
                    showNotification("‚ùå " + data.error, 'error');
                    feedback.innerHTML = `<div style="color: var(--error); font-weight: 500;">‚ùå ${data.error}</div>`;
                }
            } catch (err) {
                console.error("Error creating code:", err);
                showNotification("‚ö†Ô∏è Network error.", 'warning');
                feedback.innerHTML = '<div style="color: var(--warning); font-weight: 500;">‚ö†Ô∏è Network error. Please try again.</div>';
            }
        }

        async function lookupUser() {
            const email = document.getElementById('lookupEmailInput').value.trim().toLowerCase();
            const resultDiv = document.getElementById('lookupResult');

            if (!email) {
                showNotification("‚ö†Ô∏è Please enter an email.", 'warning');
                return;
            }

            resultDiv.innerHTML = '<div style="color: var(--text-secondary); display: flex; align-items: center; gap: var(--space-sm);"><span class="loading-spinner"></span> Looking up user...</div>';

            try {
                const response = await fetch(`${API_BASE_URL}/email-to-uid`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: window.currentUID, email })
                });

                const lookup = await response.json();

                if (!lookup.found) {
                    resultDiv.innerHTML = `<div style="color: var(--error); font-weight: 500;">‚ùå No user found for email: ${email}</div>`;
                    return;
                }

                // Now fetch user details
                const historyResponse = await fetch(`${API_BASE_URL}/user-history`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ uid: window.currentUID, target: lookup.uid })
                });

                const data = await historyResponse.json();

                if (data.error) {
                    resultDiv.innerHTML = `<div style="color: var(--error); font-weight: 500;">‚ùå ${data.error}</div>`;
                } else {
                    const codesHtml = data.redeemedCodes && data.redeemedCodes.length > 0 
                        ? data.redeemedCodes.map(codeInfo => `<li>${codeInfo.code} (+${codeInfo.quota} quota, used: ${codeInfo.usedAt})</li>`).join("")
                        : '<li>No codes redeemed</li>';
                        
                    resultDiv.innerHTML = `
                        <div style="background: var(--secondary-bg); padding: var(--space-lg); border-radius: var(--radius-md); border: 1px solid var(--border-color);">
                            <h4 style="margin-top: 0; color: var(--text-primary);">User Details</h4>
                            <div style="display: grid; gap: var(--space-sm); font-size: 0.875rem;">
                                <div><strong>Email:</strong> <span style="color: var(--text-primary);">${data.email}</span></div>
                                <div><strong>UID:</strong> <code style="font-size: 0.75rem; background: var(--tertiary-bg); padding: var(--space-xs); border-radius: var(--radius-sm);">${lookup.uid}</code></div>
                                <div><strong>Current Quota:</strong> <span style="color: var(--brand-primary); font-weight: 600;">${data.quota}</span></div>
                                <div><strong>Used Today:</strong> <span style="color: var(--text-primary);">${data.usedToday}</span></div>
                                <div><strong>Last Use:</strong> <span style="color: var(--text-primary);">${data.lastUseDate}</span></div>
                                <div><strong>Premium:</strong> <span style="color: var(--text-primary);">${data.isPremium ? 'Yes' : 'No'}</span></div>
                                <div><strong>Redeemed Codes:</strong></div>
                                <ul style="margin-left: var(--space-lg); color: var(--text-secondary);">${codesHtml}</ul>
                            </div>
                        </div>
                    `;
                }
            } catch (err) {
                console.error("User lookup failed:", err);
                resultDiv.innerHTML = `<div style="color: var(--error); font-weight: 500;">‚ö†Ô∏è Network error</div>`;
            }
        }

        // Initialize app
        document.addEventListener("DOMContentLoaded", () => {
            // Initialize theme
            initializeTheme();

            // Firebase Auth
            const firebaseConfig = {
                apiKey: "AIzaSyAaj5OXxoFaWkv9potb0eAV75Zl8oV4Iu0",
                authDomain: "veo3-generator-3aa92.firebaseapp.com",
                projectId: "veo3-generator-3aa92",
                storageBucket: "veo3-generator-3aa92.firebasestorage.app",
                messagingSenderId: "96789033293",
                appId: "1:96789033293:web:408853c3ce51c353458704"
            };

            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            const provider = new firebase.auth.GoogleAuthProvider();

            // Elements
            const guestAuth = document.getElementById("guestAuth");
            const userDropdown = document.getElementById("userDropdown");
            const signInBtn = document.getElementById("signInBtn");
            const signOutBtn = document.getElementById("signOutBtn");
            const menuSignInPrompt = document.getElementById("menuSignInPrompt");
            const menuUserContent = document.getElementById("menuUserContent");
            const adminTabBtn = document.getElementById("adminTabBtn");

            // Sign in handler
            signInBtn.addEventListener("click", async () => {
                try {
                    const result = await auth.signInWithPopup(provider);
                    console.log("User signed in:", result.user);
                } catch (error) {
                    console.error("Login error:", error);
                    showNotification(`Login failed: ${error.message}`, 'error');
                }
            });

            // Sign out handler
            signOutBtn.addEventListener("click", async () => {
                try {
                    await auth.signOut();
                    console.log("User signed out");
                } catch (error) {
                    console.error("Logout error:", error);
                    showNotification(`Logout failed: ${error.message}`, 'error');
                }
            });

            // Auth state observer
            auth.onAuthStateChanged(async (user) => {
                currentUser = user;
                
                if (user) {
                    // User signed in
                    window.currentUID = user.uid;
                    
                    // Update UI for signed-in state
                    guestAuth.classList.add('hidden');
                    userDropdown.classList.remove('hidden');
                    menuSignInPrompt.classList.add('hidden');
                    menuUserContent.classList.remove('hidden');
                    
                    // Update user info
                    const username = user.email.split("@")[0];
                    document.getElementById("userName").textContent = username;
                    document.getElementById("userEmail").textContent = user.email;
                    document.getElementById("userAvatar").textContent = username.charAt(0).toUpperCase();
                    
                    // Show admin tab if admin
                    if (isAdmin(user.uid)) {
                        adminTabBtn.classList.remove('hidden');
                    }
                    
                    // Load user data
                    await updateQuotaCounter();
                    console.log("Your UID:", user.uid);
                    
                } else {
                    // User signed out
                    window.currentUID = null;
                    currentUser = null;
                    
                    // Update UI for guest state
                    guestAuth.classList.remove('hidden');
                    userDropdown.classList.add('hidden');
                    menuSignInPrompt.classList.remove('hidden');
                    menuUserContent.classList.add('hidden');
                    adminTabBtn.classList.add('hidden');
                    
                    // Close dropdown if open
                    document.getElementById('dropdownMenu').classList.remove('show');
                    
                    // Switch to enhance tab if on restricted tabs
                    const activeTab = document.querySelector('.tab-content.active');
                    if (activeTab && (activeTab.id === 'menuTab' || activeTab.id === 'adminTab')) {
                        switchTab('enhance');
                    }
                }
            });

            // Allow uppercase input for redeem codes
            const redeemCodeInput = document.getElementById('redeemCodeInput');
            const adminCodeInput = document.getElementById('adminCodeInput');
            
            if (redeemCodeInput) {
                redeemCodeInput.addEventListener('input', function() {
                    this.value = this.value.toUpperCase();
                });
            }
            
            if (adminCodeInput) {
                adminCodeInput.addEventListener('input', function() {
                    this.value = this.value.toUpperCase();
                });
            }

            // Initialize slider values
            updateSliderValue('filmGrain');
            updateSliderValue('chromaticAberration');
        });
    </script>
</body>
</html>
